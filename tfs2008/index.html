<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>Martin Woodward: tfs2008 Archives</title>

<link rel="stylesheet" href="http://www.woodwardweb.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/MartinWoodward" />

<script language="javascript" type="text/javascript">
function OpenComments (c) {
    window.open(c,
                    'comments',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}
</script>


<!-- Google tracker -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-71966-1";
urchinTracker();
</script>

</head>

<body>

<div id="banner">
	<H1><SPAN CLASS="textVersion">Martin Woodward</SPAN></H1>
</div>

<div id="content">


<div id="intro">
This is the personal weblog for <A HREF="http://www.woodwardweb.com">Martin Woodward</A>.

If you are interested in a <A HREF="http://www.teamprise.com">Team Foundation Server (TFS) Plugin for Eclipse</A> then please visit <A HREF="http://www.teamprise.com">Teamprise</A> who not only happen to pay my wages, but also kindly host this site for me.

A list of available feeds for my site can be found <A HREF="http://www.woodwardweb.com/personal/000263.html">here</A>.
</div>

<div class="blog">




<h2 class="date">August 12, 2008</h2>


<div class="blogbody">

<a name="000444"></a>
<a href="http://www.woodwardweb.com/tfs/000444.html">
<h3 class="title">Creating a TFS 2008 with SP1 Slipstreamed ISO image</h3>
</a>
<p>Now that TFS 2008 SP1 is here, time to create a version of the TFS installer media that just contains the bits with SP1 applied.&#160; This is essential for installations targeting SQL Server 2008, but also makes the installation process onto Windows Server 2008 much easier and any installation faster (otherwise you have to install TFS 2008, then apply the service pack).&#160; Note that this is only required for new TFS installations - if you already have TFS installed then you are best of simply running the excellent service pack installer and it will do the business.&#160; Hopefully in a few weeks Microsoft will make a TFS 2008 with SP1 ISO image available, but in the meantime I thought I would write up the process of creating your own as I did mine.</p>  <p><strong>Update</strong>:&#160; After creating the patched install of everything and running it, there were errors for the Team Build and Proxy installers.&#160; Talking with fellow MVP <a href="http://geekswithblogs.net/etiennetremblay/Default.aspx">Etienne Tremblay</a> this is apparently a known issue, documented as such (d'oh, I should really RTFM) and that slipstreaming of the Build and Proxy stuff is not supported at this present time.&#160; I've therefore updated this post to include the TFS SP1 rather than patched Build and Proxy installations so that you can do it the old fashioned way of installing, then patching...</p>  <p><strong>Pre-requisites</strong></p>  <ul>   <li>TFS 2008 Installation DVD (Workgroup, <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=B0155166-B0A3-436E-AC95-37D7E39A440C&amp;displaylang=en">Trial</a> or Full) </li>    <li><a href="http://go.microsoft.com/fwlink/?LinkId=124829">TFS 2008 Service Pack 1</a> </li>    <li>An iso creating tool (I will use <a href="http://isorecorder.alexfeinman.com/isorecorder.htm">ISORecorder</a> because it is good, free and works on Windows Vista x64). </li>    <li>A couple of gigs worth of spare hard disk space to work in. </li> </ul>  <p><strong>Slipstreaming the TFS Installation Files</strong></p>  <ol>   <li>First, you must copy the contents of the TFS installation media onto a temporary folder on your hard drive. In my case I have created a folder called D:\tfs_sp1\source and copied the contents there.      <br /><a href="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/source_2.png"><img style="float: none; margin-left: 25px" height="253" alt="D:\tfs_sp1\source" src="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/source_thumb.png" width="325" /></a> </li>    <li>Extract the contents of the TFS installer executable by running the following command:      <br /><code>en_visual_studio_team_system_2008_team_foundation_server_service_pack_1_x86_x64wow.exe /extract:&lt;location&gt;</code>       <br /><a href="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/Administrator%20Admin%20Cmd%20(2)_2.png"><img style="float: none; margin-left: 25px" height="318" alt="Administrator command shell running extract command." src="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/Administrator%20Admin%20Cmd%20(2)_thumb.png" width="500" /></a> </li>    <li>Run the following command to apply the patch to the contents of the main TFS application installation folder (AT):      <br /><code>msiexec /a &lt;RTM Source Dir&gt;\AT\vs_setup.msi /p TFS90sp1-KB949786.msp TARGETDIR=&lt;SP1 Target Dir&gt;\AT</code>       <br /><a href="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/Administrator%20Admin%20Cmd%20(3)_2.png"><img style="float: none; margin-left: 25px" height="317" alt="Administrator command shell with AT patch command showing" src="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/Administrator%20Admin%20Cmd%20(3)_thumb.png" width="500" /></a> </li>    <li>Note that slipstreaming the Build and Proxy installations is not supported at this time.&#160; Also, the sharepoint extensions folder&#160; (wssExt) does not need patching so we can just copy these over. </li>    <li>Because slipstreaming the Build and Proxy is not supported, you will also want to copy over the original service pack .exe file so that you can run it after installing them. </li>    <li>Also, the Team Foundation Server client (Team Explorer) requires Visual Studio 2008 SP1, not the service pack for TFS.&#160; If you installed Team Explorer without the service pack onto a SP1 server then bad things can happen (I've seen class serialization errors but you might see other symptoms) - therefore you might want to exclude the TFC folder from this SP1 disc so that you have to install it from a Visual Studio Team Suite disc instead - hopefully remembering to run Visual Studio SP1 afterwards.&#160; However if, like me, you frequently install Team Explorer onto your TFS servers so that you can manage them directly from the server then you might want to also include the offline installation for Visual Studio on your new ISO image, that way you can quickly get access to the service pack.&#160; To get hold of the offline installer, download the <a href="http://go.microsoft.com/fwlink/?LinkId=122095">Visual Studio 2008 SP1 iso image</a>, mount the image and then copy the vs90sp1 folder.&#160; </li>    <li>While you are at it, you might as well download the latest copy of the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=ff12844f-398c-4fe9-8b0d-9e84181d9923">TFS Install Guide</a>.&#160; If you are really fancy you can copy all the files over from the root of the RTM source and edit the setup.ini file to point to the new version of the document (mine is TFSInstall-RTM-v080811.chm). </li>    <li>Now we have a nice little package that contains all the bits we need to install TFS SP1 onto a server.&#160; Mine looks like this:&#160; <br /><a href="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/withsp1%20(2)_2.png"><img style="float: none; margin-left: 25px" height="353" alt="withsp1 (2)" src="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/withsp1%20(2)_thumb.png" width="500" /></a>       <br />If we go look inside the AT folder and check the file versions, we can see which assemblies were patched.&#160; The TFS2008 RTM versions of the assemblies were 9.0.21022.8 but the TS 2008 SP1 versions are 9.0.30729.1       <br /><a href="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/Tools_2.png"><img style="float: none; margin-left: 25px" height="246" alt="Tools" src="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/Tools_thumb.png" width="600" /></a> </li>    <li>You could just burn the contents of your SP1 folder to a DVD, but I personally like to have it as an ISO image so that I can easily archive it and point to it from a Virtual PC. To create an ISO image using the excellent <a href="http://isorecorder.alexfeinman.com/">ISORecorder</a> is very easy - just right click on your SP1 folder and select &quot;Create ISO Image&quot;.       <br /><a href="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/CD%20Recording%20Wizard%20(2)_2.png"><img style="float: none; margin-left: 25px" height="309" alt="ISO Recorder" src="http://www.woodwardweb.com/WindowsLiveWriter/CreatingaTFS2008withSP1SlipstreamedISOim_96D9/CD%20Recording%20Wizard%20(2)_thumb.png" width="500" /></a> </li> </ol>  <p>And there you have it. A handy ISO image that should speed up your TFS installations no end.&#160; Happy installing!</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs/000444.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs/000444.html"> 2:06 PM</a>
	
	| <a href="http://www.woodwardweb.com/tfs/000444.html#comments">Comments (2)</a>
	
	
</div>

</div>





<h2 class="date">August 11, 2008</h2>


<div class="blogbody">

<a name="000443"></a>
<a href="http://www.woodwardweb.com/vsts/000443.html">
<h3 class="title">Visual Studio Team System 2008 SP1 Now Available!</h3>
</a>
<p><img height="128" alt="teamsystem_sp1_badge" src="http://www.woodwardweb.com/WindowsLiveWriter/VisualStudioTeamSystem2008SP1NowAvailabl_10261/teamsystem_sp1_badge_f1907226-7658-42a3-af60-23d8d4b0ab15.gif" width="256" align="right" /> That's right folks, 2008 SP1 is now available for everyone to download.&#160; Get it while it's hot!</p>  <p><a href="http://www.microsoft.com/downloads/details.aspx?familyid=fbee1648-7106-44a7-9649-6d9f6d58056e">Visual Studio 2008 SP1</a> (needed for Visual Studio and Visual Studio Team System client, including Team Explorer), (<a href="http://www.microsoft.com/downloads/details.aspx?familyid=fbee1648-7106-44a7-9649-6d9f6d58056e">exe version</a>) (<a href="http://www.microsoft.com/downloads/details.aspx?familyid=27673c47-b3b5-4c67-bd99-84e525b5ce61">iso image version</a>)</p>  <p><a href="http://www.microsoft.com/downloads/details.aspx?familyid=9e40a5b6-da41-43a2-a06d-3cee196bfe3d">Visual Studio Team Foundation Server 2008 SP1 (needed for the server, build server and proxy server)</a></p>  <p>Note that to install TFS 2008 SP1 on Windows Server 2008 with SQL Server 2008, you must create a <a href="http://blogs.msdn.com/aabdou/archive/2008/05/13/team-foundation-server-sp1-beta-now-available.aspx">slipstreamed install</a>.&#160; Also - if you have installed any of the pre-release bits on a client machine then you should run the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A494B0E0-EB07-4FF1-A21C-A4663E456D9D&amp;displaylang=en">Visual Studio 2008 Service Pack Preparation Tool</a> first.</p>  <p>For more information on what is in this release from a TFS perspective, see <a href="http://blogs.msdn.com/bharry/archive/2008/04/28/team-foundation-server-2008-sp1.aspx">Brian Harry's blog post</a> or listen to <a href="http://www.radiotfs.com/2008/06/03/RadioTFS06TeamFoundationServer2008SP1.aspx">Radio TFS Episode #6</a>.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000443.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000443.html"> 6:35 PM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000443.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">August  5, 2008</h2>


<div class="blogbody">

<a name="000442"></a>
<a href="http://www.woodwardweb.com/podcasting/000442.html">
<h3 class="title">Radio TFS is back with Version Control 101</h3>
</a>
<p><a href="http://www.radiotfs.com/"><img height="150" alt="Radio TFS" src="http://www.woodwardweb.com/WindowsLiveWriter/RadioTFSisbackwithVersionControl101_AC6C/radiotfs_b3cdbd08-04fe-42c7-8c80-77038b709db0.jpg" width="150" align="right" /></a> In this <a href="http://www.radiotfs.com/2008/08/05/RadioTFS08BasicsOfTFSVersionControl.aspx" target="_blank">first episode back from the summer break</a> we talk about the features available in TFS Version Control and talk about some of the fundamental concepts that you should understand to make your life easier.&#160; Don't forget to stay tuned all the way to the end when I offer up a brainteaser for everyone and Paul goes crazy and offers a FULL copy of Microsoft Visual Studio 2008 Team Suite to a lucky listener drawn at random who provides a correct answer to <a href="mailto:radiotfs@gmail.com">radiotfs@gmail.com</a> before the end of August 2008.</p>  <p>If that is not enough for you, Mickey is <a href="http://shrinkster.com/10wz" target="_blank">running a competition over at Team System Rocks</a> where you could win a years MSDN Premium Subscription with Visual Studio Team Suite.</p>  <p>Don't forget that you can subscribe to the show using the <a href="http://feeds.feedburner.com/radiotfs" target="_blank">RSS Feed</a> in <a href="http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id=274094361">iTunes</a> or <a href="zune://subscribe/?Radio%20TFS=http://feeds.feedburner.com/radiotfs">Zune</a>. You can also <a href="http://feeds.feedburner.com/%7Er/radiotfs/%7E5/356228001/radiotfs_008.mp3">listen to the show direct</a>.</p>  <p>For feedback or suggestions for future shows please contact us at <a href="mailto:radiotfs@gmail.com">radiotfs@gmail.com</a> or <a href="http://www.radiotfs.com/CommentView,guid,ebeaa1cc-1ccf-47e6-b19c-82c404ddd1ef.aspx#commentstart">leave a comment over at the Radio TFS web site</a>.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/podcasting/000442.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/podcasting/000442.html">12:18 PM</a>
	
	| <a href="http://www.woodwardweb.com/podcasting/000442.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">July 23, 2008</h2>


<div class="blogbody">

<a name="000441"></a>
<a href="http://www.woodwardweb.com/tfs/000441.html">
<h3 class="title">Behind Brian the Build Bunny</h3>
</a>
<p><a href="http://www.youtube.com/watch?v=Is32fWJJA-I" target="_blank"><img height="250" alt="Watch the Brian the Build Bunny video in full" src="http://www.woodwardweb.com/WindowsLiveWriter/BehindBriantheBuildBunny_D2A9/brian_whiteboard_23c64a49-4965-4c8a-8355-e73a041120ab.gif" width="295" align="right" /></a> Since posting about <a href="http://www.woodwardweb.com/gadgets/000434.html" target="_blank">Brian the Build Bunny</a>, I have been getting a steady stream of emails from people who would like to know more about how it works.</p>  <p><a href="http://msdn.microsoft.com/en-us/magazine/cc507647.aspx" target="_blank">Team Foundation Server provides a mechanism by which you can subscribe to events when certain things happen</a>.&#160; This is actually how many of the components in TFS are integrated between themselves and like the rest of the TFS glue - Microsoft make these events available so you can customize your TFS instance.</p>  <p>At a high level, I purchased a <a href="http://www.nabaztag.com/" target="_blank">Nabaztag</a> bunny and decorated it with the Visual Studio logo and Brian the Build Bunny was born. The code behind Brian the Build Bunny is actually very simple, a web service (in my case sat in IIS on my TFS server) listens for the events and then converts this into a string on text which it sends to the Nabaztag servers.&#160; Nabaztag run this text through a Text to Speech engine and generate an MP3 file with the results, they then notify my build bunny about the MP3 file and he downloads the file over his WiFi connection and plays it on his speakers.</p>  <p>But if you want the full gory details then read on.</p> 


<p>  <h4>Brian the Build Bunny Project.</h4>  <p><strong>Pre-requisites:</strong></p>  <ul>   <li>1 Team Foundation Server instance (a VPC one to play with first is recommended) </li>    <li>1 Nabaztag bunny </li>    <li>1 Wifi connection to the internet for the bunny to use </li>    <li>1 sheet of clear labels (to print the Visual Studio logo as Brian's bow tie).&#160; I used Avery J8560, but then again I'm a crazy European with metric pages. </li> </ul>  <p><strong>Preparation:</strong></p>  <ol>   <li>Ensure your bunny is registered with Nabaztag and you have your serial number and API token. </li>    <li>Ensure your Team Foundation Server instance (or where-ever you want to host the &quot;bunny listener&quot;) code has internet access so that it is able to talk to the Nabaztag server.&#160; Try pasting the following URL into Internet Explorer on the TFS instance to make sure you can get out and talk to Nabaztag:      <br />      <pre>http://api.nabaztag.com/vl/FR/api.jsp?sn=SERIAL&amp;token=TOKEN&amp;voice=UK-Mistermuggles&amp;tts=Hello+my+name+is+Brian+the+Build+Bunny.</pre><br />
Remembering to insert your build bunny's serial number and API token obtained when you registered your bunny with Nabaztag. </li></p>

<p>  <li>Download the image <a title="http://www.woodwardweb.com/brian/files/teamsystem.png" href="http://www.woodwardweb.com/brian/files/teamsystem.png" target="_blank">teamsystem.png</a> (70 KB) and print out the Team System logo on a clear label.&#160; Cut around the logo and stick onto your bunny to turn him into a smart looking Build Bunny. </li><br />
</ol></p>

<p><strong>Code:</strong></p>

<p>You can download the example code using the following link, (VS 2008 project using C# in .NET 2.0):</p>

<p><a href="http://www.woodwardweb.com/brian/files/BunnyLink.zip" target="_blank"><img style="float: none; margin-left: 25px" height="64" alt="sln_download" src="http://www.woodwardweb.com/WindowsLiveWriter/BehindBriantheBuildBunny_D2A9/sln_download_0e46ec2d-c737-4656-b8c6-533a3265a065.gif" width="250" /></a> </p>

<p>There are many ways to listen for Team Foundation Server SOAP events. You can have a &quot;proper&quot; web service living on IIS, or you have have a hosted WCF process listening to a particular port. In my particular case I was happy with the IIS approach and so used the excellent <a href="http://blogs.conchango.com/howardvanrooijen/archive/2007/06/14/TFS-Notification-Web-Services-Project-Template-v.1.2.aspx" target="_blank">Team Foundation Server Notification Event project template</a> from <a href="http://blogs.conchango.com/howardvanrooijen/" target="_blank">Howard van Rooijen</a> at <a href="http://www.conchango.com/" target="_blank">Conchango</a> as that's the fastest way to get up and running when doing this type of project.&#160; If you wanted to go down the WCF route then take a look at <a href="http://geekswithblogs.net/hinshelm/" target="_blank">Martin Hinshelwood</a>'s <a href="http://codeplex.com/TFSEventHandler" target="_blank">TFS Event Handler project up on CodePlex</a>.</p>

<p>I created a quick class library that is a thin wrapper over the Nabaztag API, and exposes functionality via the Bunny class including building and sending of the HTTP message to the Nabaztag servers. <br/><img style="float: none; margin-left: 25px" height="207" alt="Bunny class diagram" src="http://www.woodwardweb.com/WindowsLiveWriter/BehindBriantheBuildBunny_D2A9/bunny_class_36af2a05-26b6-4a6b-a0cb-13a80ed07088.gif" width="481" />&#160; </p>

<p>I then created a TFS Web Services Notification project (using <a href="http://blogs.conchango.com/howardvanrooijen/archive/2007/06/14/TFS-Notification-Web-Services-Project-Template-v.1.2.aspx" target="_blank">Howard's template</a>).&#160; This gives me ready-made code to hook into various events - but I just wanted the build completion event and the check-in event for this example.</p>

<p>Build completion event: 
  <br /><img style="float: none; margin-left: 0px" height="471" alt="Build Completition Code" src="http://www.woodwardweb.com/WindowsLiveWriter/BehindBriantheBuildBunny_D2A9/build_notification_code_f23f6410-492f-4a29-b76b-a3c934369c59.gif" width="770" /></p>

<p>Check-in event:<br/><img style="float: none; margin-left: 0px" height="473" alt="Code executed on check-in event" src="http://www.woodwardweb.com/WindowsLiveWriter/BehindBriantheBuildBunny_D2A9/checkin_event_code_d3c033b2-085e-46d5-bc35-a9a1bce2e2d8.gif" width="772" /></p>

<p>As you can see, I really don't do that much - just build up a string based on the data in the TFS event and then send that string to the bunny.</p>

<p><strong>Subscribing the Bunny Listener to the TFS Events</strong></p>

<p>Finally, once the web services are ready and listening - I must now tell TFS to send a SOAP message to my web services at the appropriate time.&#160; To do this, I used the command line tool BisSubscribe.exe.&#160; This can be found on your TFS server in the %ProgramFiles%\Microsoft Visual Studio 2008 Team Foundation Server\TF Setup directory. </p>

<p>If you open up a command prompt and cd to it then you can type:</p>

<p></p>

<pre>bissubscribe /eventType BuildCompletionEvent /address http://localhost:8181/bunnylisener/BuildCompletionEndpoint.asmx /deliveryType Soap /server http://localhost:8080
bissubscribe /eventType CheckinEvent /address http://localhost:8181/bunnylisener/CheckInEndpoint.asmx /deliveryType Soap /server http://localhost:8080</pre>

<p>Where the webservices are running at <code>http://localhost:8181/bunnylistener</code>.</p>

<p><strong>Exercises for the Reader:</strong></p>

<p><strong></strong></p>

<p>As you can see, the code above is just a starter.&#160; There are many things that you can get this new notification device to do and the code above is designed more of a sample that I can use in a talk rather than full on production code. That said, if anyone is interested in starting up a CodePlex project around this then please drop me a line.&#160; However, the following things are on my TODO list:</p>

<ul>
  <li>Subscribe to BuildCompletionEvent2 which has some more relevant information </li>

<p>  <li>Use the GlobalSecurityService API to obtain the users real names and speak those rather than the userid. </li></p>

<p>  <li>Store the bunny config data in web.config rather than hard-coding bunny details in BunnyConstants class </li></p>

<p>  <li>Allow multiple bunnies to be registered (perhaps with a UI), allow each voice to be separately configured </li></p>

<p>  <li>Make sending of messages to Nabaztag asynchronous </li><br />
</ul></p>

<p>Additionally - rather than using the eventing service to trigger Brian on build completition events, it might be interesting to write the &quot;Bunny Link&quot; as a windows service and get it to subscribe to the build queue using the same API as demonstrated by my <a href="http://www.woodwardweb.com/vsts/000395.html" target="_blank">Build Wallboard sample</a>.&#160; That way you could make Brian talk when a build was queued or many other things.</p>

<p>If anyone has any questions or would like more details then please drop me a line.</p>


<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs/000441.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs/000441.html"> 4:31 PM</a>
	
	| <a href="http://www.woodwardweb.com/tfs/000441.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">July  9, 2008</h2>


<div class="blogbody">

<a name="000440"></a>
<a href="http://www.woodwardweb.com/teamprise/000440.html">
<h3 class="title">Teamprise 3.1 is now available</h3>
</a>
<p>At the Microsoft <a href="https://partner.microsoft.com/global/40018508" target="_blank">Worldwide Partner Conference</a> in Houston today, Corey Steffen (General Manager of Teamprise and the guy that pays my wages) announced the <a href="http://www.teamprise.com/" target="_blank">public availability of Teamprise 3.1</a>.</p>  <p>This is a maintenance release free to everyone with a valid Teamprise 3.0 license and includes several bug fixes along with a few new features.&#160; For the proper release notes, take a look <a href="http://download-us.teamprise.com/cs/3.1.0.8392R/release-notes/release-notes.html" target="_blank">here</a>.&#160; However I just wanted to point out a few highlights.</p>  <p><a href="http://www.woodwardweb.com/WindowsLiveWriter/Teamprise3.1isnowavailable_C053/online_2.png"><img height="97" alt="New Online dialog" src="http://www.woodwardweb.com/WindowsLiveWriter/Teamprise3.1isnowavailable_C053/online_thumb.png" width="200" align="right" /></a> </p>  <h4>Improved Offline Support</h4>  <p>With-out doubt, the biggest new feature in Teamprise 3.1 for most people will be the improved offline support. If you right click on a project in the Eclipse IDE, you are now presented with a &quot;Go Offline&quot; option which allows you to tell Teamprise not to bother trying to talk to TFS for a while (previously you had to restart Eclipse for Teamprise to ask you if you wanted to go offline, and only then after it had tried *really* hard to connect).</p>  <p>While offline, you can still perform all the file operations like you expect -- you can add, edit, move and delete files just like if you were online.</p>  <p>When you want to come back online (say when you have stepped back out of the plane, bus, meeting room), you can right click on the project and say &quot;Return Online&quot; and Teamprise will do it's best to detect what changes have happened while you were away, giving you the option to pend those changes.</p>  <p>There is even &quot;return online&quot; capability in the stand-alone client Teamprise Explorer which is very neat and makes working with tools that are not TFS aware a little easier too.&#160; The actual algorithm used by the return online feature is more sophisticated than just checking for read/write status in your local workspace, we also do some magic and compare checksums of the file contents etc.&#160; Fellow Teamprise blogger <a href="http://www.edwardthomson.com/blog/" target="_blank">Ed Thomson</a> was the lead developer for the offline work and he has some <a href="http://www.edwardthomson.com/blog/2008/07/teamprise_31.html" target="_blank">more details on his blog</a>.</p>  <h4>TFS 2008 SP1 New Feature Support</h4>  <p>Service Pack 1 of Team Foundation Server 2008 is hopefully due out soon, and with it come <a href="http://blogs.msdn.com/bharry/archive/2008/04/28/team-foundation-server-2008-sp1.aspx" target="_blank">lots of lovely new features</a>. We took advantage in the timing of our 3.1 release to update Teamprise to support some of the new server capabilities so that they are available to our customers as soon as TFS 2008 SP1 arrives.&#160; These include:</p>  <ul>   <li>Last check-in date/time column (<a href="http://www.woodwardweb.com/teamprise/000436.html" target="_blank">see my previous post about this feature</a>) </li>    <li>Support for work item meta-data filtering option (note that this option is already being used on some of the CodePlex servers so if you use Teamprise to talk to the work item functionality in CodePlex then you probably want to upgrade to Teamprise 3.1, <a href="http://www.woodwardweb.com/teamprise/000339.html" target="_blank">after all the price is right</a> :-) ).</li>    <li><code>tf branch -checkin</code> command, the fastest way to create large branches and perform the check-in at the same time. </li> </ul>  <h4>Command Line Client Improvements</h4>  <p>In this release we are making publicly available a bunch of improvement and new features that we added to our command line client after some great feedback from one particular customer who has un-questionably the largest and most demanding Team Foundation Server install base on the planet. In particular we have added the &quot;-format:xml&quot; option for most commands in addition to the usual -format:brief and -format:detailed.&#160; The -format:xml option will output data from the command line client in a format easily XML parseable without truncating output which makes it much easier to use and parse command line output in scripting scenarios.&#160; However, there have been many more improvements so check out the <a href="http://download-us.teamprise.com/cs/3.1.0.8392R/release-notes/release-notes.html" target="_blank">release notes</a> for more information.</p>  <p><img height="195" alt="Look Ma, no asterisk" src="http://www.woodwardweb.com/WindowsLiveWriter/Teamprise3.1isnowavailable_C053/te64bit_2fb716f9-a6d9-4d6b-8bf9-3e08825e3fc6.png" width="240" align="right" /></p>  <h4>64-bit support on Windows.</h4>  <p>Not really worth calling out separately only to say that Teamprise is now <strong>the world's first commercially available x64 TFS client for Windows</strong> :-) </p>  <p>While we are a Java application, <a href="http://www.woodwardweb.com/java/000223.html" target="_blank">as mentioned before</a>, we have a bit of JNI code to do the stuff not possible from all the JRE versions that we support (such as native authentication on Windows or making a file writable).&#160; Also we use SWT to give us a native look and feel on all platforms and SWT works by using lots of JNI to do the presentation calls.&#160; This meant that if you tried to run Teamprise under a x64 Java runtime we died pretty quickly.&#160; We've had x64 support available for other platforms for a while (including Linux), but with Windows x64 support coming in Eclipse 3.4 we took the opportunity to compile our JNI code over to the Win32 x64 architecture and it works great.</p>  <p>On a personal note, during this activity I had to fix some bits in the core Eclipse 3.4 codebase (specifically PDE for people that are interested) and the small patches that I submitted have been applied into the main Eclipse project which is a nice feeling. Eclipse is a poster-child of open source projects and it is with some pride that I can tell people I have contributed code into it. It's also nice that as Teamprise is a commercial company that uses a lot of the Eclipse code and is an Eclipse Foundation member, we are able to do our bit and contribute something back for the benefit of all.</p>  <p>As you can see, we've been busy. We've hopefully cleared some adoption blockers for some of our customers, done quite a few bug fixes and performance improvements and thrown in some new features along the way.&#160; While the headline grabbing features of interest to most people are probably the offline support and the 64-bit support, I'm very proud of this as a solid &quot;point&quot; release and I would encourage everyone with a valid 3.0 license to upgrade.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/teamprise/000440.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/teamprise/000440.html">10:28 PM</a>
	
	| <a href="http://www.woodwardweb.com/teamprise/000440.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">June  5, 2008</h2>


<div class="blogbody">

<a name="000436"></a>
<a href="http://www.woodwardweb.com/teamprise/000436.html">
<h3 class="title">Last Check-in Date Explained</h3>
</a>
<p>I've been doing a lot of work with the Team Foundation Server 2008 SP1 Preview, and even recorded a <a href="http://www.radiotfs.com/2008/06/03/RadioTFS06TeamFoundationServer2008SP1.aspx" target="_blank">podcast about it</a> (also see <a href="http://blogs.msdn.com/bharry/default.aspx" target="_blank">Brian Harry's</a> <a href="http://blogs.msdn.com/bharry/archive/2008/04/28/team-foundation-server-2008-sp1.aspx" target="_blank">blog post for more details on TFS 2008 SP1 features</a>).</p>  <p>One out of the many new features introduced in TFS 2008 SP1 is the &quot;Last Check-in&quot; column in the source control explorer. It is a handy little thing that I think a lot of people will find useful.&#160; </p>  <p><img style="float: none; margin-left: 25px" height="146" alt="Last Check-in Date Column in Visual Studio Source Control Explorer" src="http://www.woodwardweb.com/WindowsLiveWriter/LastCheckinDateExplained_D760/last_check_in_small_9c8299e2-3d57-4e69-8818-376287f412a5.gif" width="400" /></p>  <p>However just a couple of warnings for you for behaviour that you might not expect at first.</p>  <ol>   <li>The date shown for folders is the date that the folder was added, <strong>not</strong> the last date that any contents of that folder where checked in.&#160; That means you cannot use it to drill down onto the most recently changes files - to find that out you should still do a &quot;View History&quot; on the parent folder and look at the changesets. </li>    <li>If you are using a Visual Studio 2008 SP1 client (or Teamprise 3.1 for that matter when it is released) and you point it at a server prior to TFS 2008 SP1 (i.e. TFS 2005 or the RTM release of TFS 2008) then you do not get any data in this column because the server doesn't send back that data to the client. </li> </ol>  <p>Otherwise it works pretty much as you expect.&#160; Most useful is that you can obviously sort the column to find the recently changed files in a big list of files.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/teamprise/000436.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/teamprise/000436.html"> 3:51 PM</a>
	
	| <a href="http://www.woodwardweb.com/teamprise/000436.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">May 30, 2008</h2>


<div class="blogbody">

<a name="000435"></a>
<a href="http://www.woodwardweb.com/gadgets/000435.html">
<h3 class="title">Brian the Build Bunny Backgrounds</h3>
</a>
<p><a title="Click here for a selection of Wallpaper sizes" href="http://www.woodwardweb.com/brian/wallpaper/" target="_blank"><img height="195" alt="Brian the Build Bunny Wallpaper" src="http://www.woodwardweb.com/WindowsLiveWriter/BriantheBuildBunnyBackgrounds_A116/brian_preview_19c48495-8feb-4501-ad42-d7b99de5a852.jpg" width="244" align="right" /></a> It turns out that the <a href="http://www.woodwardweb.com/gadgets/000434.html" target="_blank">little video I posted yesterday</a> has taken on a bit of a life of it's own.&#160; Last time I checked, it was in the top 10 Science and Technology posts for YouTube in Ireland.&#160; It's funny how it is always the posts that you do more for your own entertainment that take off.&#160; </p>  <p>Anyway, there is no doubting that Brian is a bit of a character, he's already recorded his first TV appearance as a guest on this weeks, &quot;<a href="http://channel9.msdn.com/shows/This_Week_On_Channel_9" target="_blank">This Week in Channel 9</a>&quot; (to be broadcast soon).&#160; I wish that Nabaztag had an affiliate program as it sounds like I may have sold a few rabbits for them.&#160; </p>  <p>Anyway, if you can't afford your own bunny, then you can have the next best thing for free.&#160; Your very own <a href="http://www.woodwardweb.com/brian/wallpaper/" target="_blank">Brian the Build Bunny Background</a> on the desktop of a computer near you (standard and widescreen versions available).&#160; <a href="http://www.woodwardweb.com/brian/wallpaper/" target="_blank">Click here to chose a image size that suits you</a>.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/gadgets/000435.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/gadgets/000435.html">11:40 AM</a>
	
	| <a href="http://www.woodwardweb.com/gadgets/000435.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">May 28, 2008</h2>


<div class="blogbody">

<a name="000434"></a>
<a href="http://www.woodwardweb.com/gadgets/000434.html">
<h3 class="title">Brian the Build Bunny</h3>
</a>
<p>I'm always keen try new and novel ways to keep in touch with the status of my software projects.&#160; Fortunately, Team Foundation Server provides many ways to do this.&#160; While the <a href="http://www.woodwardweb.com/vsts/000395.html">Build Wallboard</a> is fun if you have a spare monitor and machine lying around, I wanted to experiment with some inexpensive dedicated devices, and so Brian the Build Bunny was born. </p>  <div class="wlWriterSmartContent" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:2e205f46-9fcf-4ee7-95e9-871f98b30965" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px"><div id="2b3a974d-99ed-4fc5-a671-1312a3e59499" style="margin: 0px; padding: 0px; display: inline;"><div><a href="http://www.youtube.com/watch?v=Is32fWJJA-I&amp;hl=en" target="_new"><img src="http://www.woodwardweb.com/WindowsLiveWriter/413058e9f27a_134BB/video626a89d530c0.jpg" galleryimg="no" onload="var downlevelDiv = document.getElementById('2b3a974d-99ed-4fc5-a671-1312a3e59499'); downlevelDiv.innerHTML = &quot;&lt;div&gt;&lt;object width=\&quot;425\&quot; height=\&quot;355\&quot;&gt;&lt;param name=\&quot;movie\&quot; value=\&quot;http://www.youtube.com/v/Is32fWJJA-I&amp;hl=en\&quot;&gt;&lt;\/param&gt;&lt;param name=\&quot;wmode\&quot; value=\&quot;transparent\&quot;&gt;&lt;\/param&gt;&lt;embed src=\&quot;http://www.youtube.com/v/Is32fWJJA-I&amp;hl=en\&quot; type=\&quot;application/x-shockwave-flash\&quot; wmode=\&quot;transparent\&quot; width=\&quot;425\&quot; height=\&quot;355\&quot;&gt;&lt;\/embed&gt;&lt;\/object&gt;&lt;\/div&gt;&quot;;" alt=""></a></div></div></div>  <p>Brian is a <a href="http://www.amazon.com/Violet-Nabaztagtag-WiFi-Rabbit/dp/B000OFHBKS/woodwardwebcom">Nabaztag smart rabbit</a>.&#160; He reads out details of check-ins and builds.&#160; If a build has failed then his ears go down to show how sad he feels, but if you fix the build his ears will soon pick up again.</p>  <p>I've had Brian for about a year now waiting to do this project, but when I tried it in the past I always found the response times from the rabbit to be too slow.&#160; However earlier this year, the Nabaztag developers updated the code running the rabbits so that they are now using the XMPP (Jabber) protocol to receive updates and the service now seems pretty good.</p>  <p>Brian is now sitting on my desk chattering away and letting me know what is happening in TFS.&#160; If you want to find out more about how he works and see him in action then take a look at the <a href="http://www.youtube.com/watch?v=Is32fWJJA-I">video</a>. If your company blocks YouTube but you have Silverlight installed then you can view <a href="http://silverlight.services.live.com/invoke/15051/buildbunny/iframe.html" target="_blank">a higher quality version of the video courtesy of the Windows Live Streaming service</a>.&#160; I'll go through the code behind Brian in a later post if there is any interest, but it is pretty much a standard TFS event listener that then sends text to the rabbit using the <a href="http://api.nabaztag.com/docs/home.html">Nabaztag API</a>.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/gadgets/000434.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/gadgets/000434.html">10:22 PM</a>
	
	| <a href="http://www.woodwardweb.com/gadgets/000434.html#comments">Comments (13)</a>
	
	
</div>

</div>





<h2 class="date">May 23, 2008</h2>


<div class="blogbody">

<a name="000433"></a>
<a href="http://www.woodwardweb.com/podcasting/000433.html">
<h3 class="title">Radio TFS 05: Common Team System Questions</h3>
</a>
<p><a href="http://feeds.feedburner.com/~r/radiotfs/~5/296872926/radiotfs_005.mp3"><img height="150" alt="radiotfs" src="http://www.woodwardweb.com/WindowsLiveWriter/RadioTFS05CommonTeamSystemQuestions_1506C/radiotfs_74b55fc4-06e3-45b3-86d4-db933589e6c7.jpg" width="150" align="right"></a> I've just posted the latest installment of Radio TFS.&nbsp; I'm actually a show behind on editing so expect to see episode 6 up soon.&nbsp; However, in episode 5 Paul, Mickey and I attempt to answer some of the common questions we hear people ask about Team System including: <ul> <li>What is Team System?  <li>Which edition is right for me?  <li>Why can't I find Team Foundation Server on MSDN?  <li>What is Team Foundation Server Workgroup Edition?  <li>Is VSTS 2005 compatible with TFS 2008?  <li>Why can't I see Team Foundation Server when I install Team Suite?  <li>What are my options for migrating from my old system(s) to TFS?  <li>Can I use TFS with VB6, .NET 1.1, Eclipse etc?  <li>What is a Team Project - how should it be scoped?  <li>I deleted a file locally, I do a "Get Latest" and TFS doesn't download it - why?</li></ul> <p>As well as the usual sprinkling of tangents along the way. <p><a href="http://feeds.feedburner.com/~r/radiotfs/~5/296872926/radiotfs_005.mp3">Click here for a direct link to this episode</a>.  <p>If you have any questions that you would like answered, or if you have any comments and feedback about the show then please contact us at <a href="mailto:radiotfs@gmail.com">radiotfs@gmail.com</a> or visit the website at <a href="http://radiotfs.com">http://radiotfs.com</a> for quick links to subscribe to the feed in iTunes, Zune etc.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/podcasting/000433.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/podcasting/000433.html">11:55 PM</a>
	
	| <a href="http://www.woodwardweb.com/podcasting/000433.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">April 21, 2008</h2>


<div class="blogbody">

<a name="000427"></a>
<a href="http://www.woodwardweb.com/dotnet/000427.html">
<h3 class="title">TFS Build API by Example #1: Queue a build.</h3>
</a>
<p><a href="http://www.woodwardweb.com/WindowsLiveWriter/TFSBuildAPIbyExample1Queueabuild_C1CE/BuildAPI_2.gif" target="_blank"><img height="180" alt="Team Foundation Build API Class Diagram - larger version." src="http://www.woodwardweb.com/WindowsLiveWriter/TFSBuildAPIbyExample1Queueabuild_C1CE/BuildAPI_thumb.gif" width="240" align="right"></a> As we all know by now - the build system in TFS2008 was substantially improved.&nbsp; Along with the many improvements came an official API for talking to the build system.&nbsp; This is the same API that the Team Foundation Build UI in Visual Studio uses, however there are many additional methods that were added that were not for the UI at all but for potential consumers of the Build API.</p> <p>In talking with folks at community events, and on the MSDN forums I have realized that there isn't a huge awareness of this API.&nbsp; Having written a parallel implementation of the build API, but in Java for the Teamprise 3.0 release I have spent a great deal of time with the .NET API and have a few examples lying around of how to accomplish certain common tasks - so I thought I would run through a some of them.&nbsp; If you have an example of something you would like to see with the build API then please leave a comment for this post or drop me a line.</p> <p>So - let's start with a basic one.&nbsp; How to queue a build.&nbsp; This will introduce us to a few concepts with-in the build API that are common across all of the methods.</p> <h4>The Easy Way.</h4> <p>A quick look at the class diagram above will show you that the main interfaces you'll be dealing with in the Build API are the IBuildServer and IBuildDefinition interfaces.&nbsp; To get started with these you'll need to add references to the Microsoft.TeamFoundation.dll, Microsoft.TeamFoundation.Client.dll and Microsoft.TeamFoundation.Build.Client.dll.</p> <p><strong>C#</strong></p> <p><pre>TeamFoundationServer tfs = TeamFoundationServerFactory.GetServer(<span style="color: maroon">"http://tfsserver:8080”</span>);
IBuildServer buildServer = (IBuildServer)tfs.GetService(<span style="color: blue">typeof</span>(IBuildServer));
IBuildDefinition buildDef = buildServer.GetBuildDefinition(<span style="color: maroon">"TeamProject"</span>, <span style="color: maroon">"Build Name"</span>);
buildServer.QueueBuild(buildDef);</pre>
<p></p>
<p><strong>VB.NET</strong></p><pre><span style="color: blue">Dim</span> tfs <span style="color: blue">As</span> TeamFoundationServer = TeamFoundationServerFactory.GetServer(<span style="color: maroon">"http://tfsserver:8080"</span>)
<span style="color: blue">Dim</span> buildServer <span style="color: blue">As</span> IBuildServer = <span style="color: blue">DirectCast</span>(tfs.GetService(<span style="color: blue">GetType</span>(IBuildServer)), IBuildServer)
<span style="color: blue">Dim</span> buildDef <span style="color: blue">As</span> IBuildDefinition = buildServer.GetBuildDefinition(<span style="color: maroon">"TeamProject"</span>, “Build Name")
buildServer.QueueBuild(buildDef)
</pre>
<p>I'm afraid that's the last example you'll be seeing in VB.NET.&nbsp; Being a Java developer by day I tend to like my semi-colons.&nbsp; However if you are a VB developer then hopefully you'll be able to follow along as the rest of the examples are more or less just method calls with the occasional bit of casting.</p>
<p>So - what's going on here.&nbsp; Well we first get hold of a TeamFoundationServer object.&nbsp; If this was server side code and we wanted to specify some credentials then we would use a slightly difference mechanism but in this case the constructor works well and this will automatically connect using the credentials of the current thread.</p>
<p>Next we get hold of the build service that implements the IBuildServer interface.&nbsp; Finally we get a hold of the build definition by specifying a team project and build definition name (build definitions are unique per team project in TFS).&nbsp; We then queue a build using the defaults for that build definition.&nbsp; This API call is actually shorthand for the following...</p>
<h4>The Hard Way</h4>
<p><img height="291" alt="IBuildRequest interface diagram" src="http://www.woodwardweb.com/WindowsLiveWriter/TFSBuildAPIbyExample1Queueabuild_C1CE/IBuildRequest_c88f6dec-abba-448c-bb7e-69793aa74c21.gif" width="211" align="right"> Supposed you want to queue a build, but you don't want to use the default build agent, priority, drop location etc.&nbsp; Well in that case you need to look at the IBuildRequest interface.&nbsp; Here you will find all the options to customize the build request, you can specify a build agent, drop location, priority etc like you can do from the Visual Studio UI.&nbsp; You will also find other options such as being able to queue the build with a maximum acceptable queue position, pass a custom get version for the build or even queue the build in a postponed status.</p>
<p>In the following example, I am going to find a non-default build agent from the server and then queue a build using it.</p><pre><span style="line-height: 100%">        TeamFoundationServer tfs = <span style="color: blue">new</span> TeamFoundationServer(<span style="color: maroon">"http://tfsserver:8080"</span>);
        IBuildServer buildServer = (IBuildServer)tfs.GetService(<span style="color: blue">typeof</span>(IBuildServer));

<p>        String teamProject = <span style="color: maroon">"TeamProject"</span>;<br />
        String buildDefinitionName = <span style="color: maroon">"MyBuildDefinition"</span>;<br />
        String buildAgentName = <span style="color: maroon">"MyBuildAgent"</span>;<br />
        <br />
        <span style="color: green">// Find our (non default) build agent.</span><br />
        IBuildAgentQueryResult queryResult = buildServer.QueryBuildAgents(buildServer.CreateBuildAgentSpec(teamProject, buildAgentName));<br />
        <span style="color: blue">if</span> (queryResult.Failures.Length &gt; <span style="color: maroon">0</span> || queryResult.Agents.Length != <span style="color: maroon">1</span>)<br />
        {<br />
          <span style="color: blue">throw</span> <span style="color: blue">new</span> Exception(<span style="color: maroon">"Invalid Build Agent"</span>);<br />
        }<br />
        IBuildAgent buildAgent = queryResult.Agents[<span style="color: maroon">0</span>];</p>

<p>        IBuildDefinition buildDefinition = buildServer.GetBuildDefinition(teamProject,buildDefinitionName);</p>

<p>        <span style="color: green">// Create a build request based on our chosen definition.</span><br />
        IBuildRequest buildRequest = buildDefinition.CreateBuildRequest();<br />
        <span style="color: green">// Optionally set command line args, drop location, priority, custom source version etc here</span><br />
        <span style="color: green">// in this case just overriding default build agent.</span><br />
        buildRequest.BuildAgent = buildAgent;</p>

<p>        buildServer.QueueBuild(buildRequest);<br />
</span></pre><br />
<p>Pretty simple really and very powerful.&nbsp; I encourage you to go take a look at the IBuildServer interface to see some of the stuff that you can do.&nbsp; If you have any suggestions as to what you would like to see as a build API example then leave a comment to this post.</p></p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/dotnet/000427.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/dotnet/000427.html"> 2:23 PM</a>
	
	| <a href="http://www.woodwardweb.com/dotnet/000427.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">April  3, 2008</h2>


<div class="blogbody">

<a name="000425"></a>
<a href="http://www.woodwardweb.com/tfs/000425.html">
<h3 class="title">IMTC 2008: Automating Builds with Team Foundation Server 2008</h3>
</a>
<p>Thanks to everyone who attended my session this afternoon at IMTC 2008 in Dublin.&nbsp; As promised, here is a copy of the slide deck.&nbsp; </p> <ul> <li><a href="http://www.woodwardweb.com/talks/imtc2008.pdf">Automating Builds with Team Foundation Server 2008 (pdf - 1.26 MB)</a></li></ul> <p>Also, as mentioned - the Build Wallboard project that we did as a demo is also available at the MSDN Code Gallery here:</p> <blockquote> <p><a title="http://code.msdn.microsoft.com/buildwallboard" href="http://code.msdn.microsoft.com/buildwallboard">http://code.msdn.microsoft.com/buildwallboard</a></p></blockquote>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs/000425.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs/000425.html"> 4:02 PM</a>
	
	| <a href="http://www.woodwardweb.com/tfs/000425.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">April  2, 2008</h2>


<div class="blogbody">

<a name="000424"></a>
<a href="http://www.woodwardweb.com/java/000424.html">
<h3 class="title">CruiseControl 2.7.2 Released</h3>
</a>
<p><a href="http://www.developertesting.com/archives/individual_weblogs-jeffrey_fredrick-index.html">Jeffrey Fredrick</a> just announced that <a href="http://cruisecontrol.sourceforge.net/">CruiseControl</a> 2.7.2 is now available for download: <a href="http://tinyurl.com/2zm9mz">http://tinyurl.com/2zm9mz</a>.  <p>There are lots of bug fixes, lots of changes to the Dashboard and some new plug-ins, but the bit that is of most interest to me was (from the release notes)  <p><pre>TeamFoundationServer source control
----------------------
* Fix compatibility with Microsoft Visual Studio Team Foundation Server 2008 (CC-735). Submitted by Martin Woodward.</pre>
<p></p>
<p>This was to work around an issue that came up when using CruiseControl (java version) to talk to a TFS2008 server (TFS2005 worked fine and still does).&nbsp; If you are attempting to use CruiseControl with TFS 2008 then you should go with CruiseControl 2.7.2.&nbsp; For that matter - if you are using CruiseControl.NET with TFS then you should also take a look at the <a href="http://www.codeplex.com/TFSCCNetPlugin/Release/ProjectReleases.aspx?ReleaseId=1816">latest release</a> of the integration to TFS - as that contains the same fix allowing you to happily talk to a 2008 version of Team Foundation Server (also using the TFS 2008 client API's).</p>
<p>Anyway, congratulations to the CruiseControl team on the 2.7.2 release!</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/java/000424.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/java/000424.html"> 8:27 PM</a>
	
	| <a href="http://www.woodwardweb.com/java/000424.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">March 18, 2008</h2>


<div class="blogbody">

<a name="000421"></a>
<a href="http://www.woodwardweb.com/teamprise/000421.html">
<h3 class="title">Teamprise 3.0 Ships!</h3>
</a>
<p>At <a href="http://www.eclipsecon.org/">EclipseCon 2008</a> this morning, we just announced that <a href="http://www.teamprise.com/">Teamprise 3.0</a> has been released!&#160; If you've been wondering why I have been quiet on the blog lately - but also why anything I have been talking about is Team Foundation Build related, then you are about to find out why :-)&#160; First of all, I'd encourage you to go visit the shiny new website at <a href="http://www.teamprise.com">http://www.teamprise.com</a>.&#160; Our marketing team had too much fun putting that together, including getting a real, live, massive Teamprise power button made up and shipped in a huge crate from New York to be photographed and used as the new site/icon image.</p>

<p>The full release notes are available <a href="http://download.teamprise.com/cs/3.0/release-notes/release-notes.html">here</a>, but as has been the tradition for the past few Teamprise releases, I thought I would give you a run down of my favourite new features in the 3.0 release.</p>

<p>At a high level, the features in 3.0 can be summarised as:-</p>

<ul>
  <li>Full Team Foundation Build integration (including ability to execute Ant based builds) </li>

  <li>Check-in policy support </li>

  <li>Recursive folder compare </li>

  <li>Single sign-on (from Microsoft Windows machines) </li>

  <li>&quot;Destroy&quot; command for version control </li>

  <li>Show deleted items and undelete from Source Control Explorer UI </li>

  <li>much much more (see <a href="http://download.teamprise.com/cs/3.0/release-notes/release-notes.html">release notes</a>) </li>
</ul>

<p>While it is not my area, I should also mention that we've taken this opportunity to make our licensing <strong>more affordable for smaller teams</strong>.&#160; We have been very pleasantly surprised by the number of people buying 1 to 20 licenses at a time.&#160; Originally, Teamprise pricing was skewed to the Enterprise customers (i.e. simple, all inclusive and with steep volume discounts).&#160; So we have done a couple of things to help out the smaller companies:-</p>

<ul>
  <li>You can now purchase the various components (Teamprise Plug-in for Eclipse, Teamprise Explorer, Teamprise Command Line Client) individually as well as the Teamprise Client Suite which gives you the lot. </li>

  <li>We have lowered the initial prices for a single seat, meaning that people buying one or two licenses can now get the same discounts that used to only be available to folks purchasing 100. </li>
</ul>

<p>If you have any licensing issues / queries then feel free to contact me, or you can talk to the sales team direct at <a href="mailto:sales@teamprise.com">sales@teamprise.com</a>.&#160; Anyway - back to the part of this release that I do know about - the technology.&#160; </p>

<p>The first feature I want to talk about is one that I had no involvement with.&#160; It's one of those features that many people will not notice because it just works but anyone who has done any Java to .NET web service interop work will instantly recognise as being a little bit clever.</p>

<h4>Single Sign-On</h4>

<p><img style="float: none; margin-left: 25px" height="323" alt="New Teamprise Login Dialog" src="http://www.woodwardweb.com/teamprise/images/login.gif" width="400" /> </p>

<p>The initial log-in screen has undergone a big overhaul.&#160; On Windows machines you are given the option to use &quot;default credentials&quot;, i.e. the username and password that you are logged onto windows with.&#160; It obviously doesn't know your password, but does some JNI magic to get the native Windows API's to handle the authentication logic with Team Foundation Server.&#160; While you are also on the login screen, you may notice the Profile feature.&#160; This is an area that many people probably won't use, but we added for our power users and for ourselves.&#160; Basically, the profiles feature allows you to store sets of servers/credentials that you commonly use to connect to Team Foundation Server and then you can bring up the details using a simple drop down.&#160; Makes it much easier to switch between your production TFS instance and your CodePlex project for example - or switch credentials if you are a TFS administrator.</p>

<h4>Check-in Policy Support</h4>

<p>In Visual Studio, check-in policies are implemented as a .NET assembly runs every time a policy is evaluated or configured.&#160; The policy also has full access to the .NET API's, the Visual Studio API's as well as anything it might want to pinvoke out to on the Win32 API side.&#160; As you can imagine, this presented us some problems when we wanted to have check-in policies that ran the same in Eclipse on Windows Vista as Teamprise Explorer on the Mac or Aptana on Ubuntu - therefore we have had to develop a parallel Teamprise check-in policy framework.</p>

<p><img style="float: none; margin-left: 25px" height="380" alt="Teamprise Check-in Policies" src="http://www.woodwardweb.com/teamprise/images/policies.gif" width="500" /> </p>

<p>As we were doing this, we took the opportunity to learn from some of the feedback folks have been having with the Visual Studio check-in policies.&#160; While our framework and SDK will look very familiar to anyone that has developed a custom check-in policy for Visual Studio, you will notice some differences.</p>

<p>Firstly, we supply <strong>different policies out of the box</strong>.&#160; The vast majority of custom check-in polices that people deploy are things like &quot;Check for Comments&quot; etc, so we just shipped the common ones our customers wanted to prevent them from having to write their own.</p>

<p>Secondly, we make use of the Eclipse plug-in framework to implement our policies as extension points.&#160; This means that they are <strong>easy to deploy</strong> (using the Eclipse update site mechanisms built in to the IDE).&#160; We have also separated the configuration (stored as a blob of XML data in our framework) from the implementation - represented by the plug-in deployed.&#160; The again makes it easier to deploy, especially when it comes to version 2 of a policy...</p>

<p>Thirdly, all of our policies can be <strong>scoped by the path in version control</strong> to which they correspond - you are not limited to per Team Project scoping and you do not have to wrap your policies in a custom policy to get more detailed scoping like you do with the current Visual Studio framework.</p>

<h4>Team Foundation Build Integration</h4>

<p>Anyone that has been following this blog for a while, or who attended the <a href="http://www.woodwardweb.com/personal/000391.html">Team Build talk I did at TechEd with Brian Randell</a>, will notice that I have been increasingly involved in the inner workings of Team Foundation Build.&#160; Now you can see the fruits of that labour.</p>

<p><img style="float: none; margin-left: 25px" height="379" alt="Teamprise Build Explorer on Widows Vista" src="http://www.woodwardweb.com/teamprise/images/be_vista.gif" width="500" /> </p>

<p>In Teamprise we now have <strong>full integration</strong> with the shiny new <strong>build functionality</strong> in <strong>TFS 2008</strong> as well as support for <strong>TFS 2005</strong>.&#160; Backwards compatibility with the TFS 2005 server is very similar to if you were using a Visual Studio 2008 client, accept that ours is slightly more backwards compatible (you can create new builds on a TFS 2005 server as well as manage build qualities etc).&#160; However it is with TFS 2008 that you get to see the majority of the features.&#160; I could go on about this aspect all day as their are so small things that I am proud of, but at a high level you can:</p>

<ul>
  <li>View existing build definitions </li>

  <li>Manage builds in Build Explorer </li>

  <li>Queue new builds </li>

  <li>View build report </li>

  <li>Edit Build Quality </li>

  <li>Delete build </li>

  <li>Manage Build Qualities </li>

  <li>Open Drop Folder </li>

  <li>New/Edit Build Definition </li>
</ul>
The following features are only available against a TFS2008 server: 

<ul>
  <li>Edit Retention Policies </li>

  <li>Keep Build </li>

  <li>Set Queue Priority </li>

  <li>Postpone Build </li>

  <li>Stop/Cancel Build </li>

  <li>Delete Build Definition </li>
</ul>

<p>One of the smaller features I will call out is that from the build definition in the Team Explorer, you can right click and do a &quot;View Build Configuration&quot; that will open the Source Control Explorer at the place in which the TFSBuild.proj file is stored so that you can check it out and edit it.&#160; A feature that I added solely for my own sanity during dogfooding :-).&#160; </p>

<p><a href="http://www.woodwardweb.com/teamprise/images/be_leopard.jpg" target="_blank"><img height="180" alt="Build Explorer on Mac OS 10.5 - click for a higher res image" src="http://www.woodwardweb.com/teamprise/images/be_leopard_thumb.jpg" width="240" align="right" /></a> All this would be fairly academic, if you didn't have some way to do a cross-platform build using Team Foundation Build.&#160; In the current release, we provide a the <a href="http://www.teamprise.com/products/build/">Teamprise Extensions for Team Foundation Build</a> which basically <a href="http://www.teamprise.com/products/build/"><strong>Ant enables the Team Foundation build server</strong></a>.&#160; The Teamprise extensions are a set of MSBuild targets that insert the Ant build process into the standard Team Build mechanism as well as a custom MSBuild We hope to extend this to support in the near future to some of the other common build/test tool-chains in the cross-platform world.&#160; However, the Ant integration case will help a lot number of people out there.</p>

<p>Best yet, the <a href="http://www.teamprise.com/products/build/">Teamprise Extensions for Team Foundation Build</a> are available <strong>free of charge for everyone</strong> - wether or not you are a Teamprise customer.&#160; Also, if you want to see how they work and customize them to meet your own non-standard build system then the <a href="http://www.teamprise.com/products/build/">source is available</a> under the permissive <strong>open source</strong> Microsoft Public License (<a href="http://www.microsoft.com/resources/sharedsource/licensingbasics/publiclicense.mspx">MS-PL</a>).</p>

<p>I would personally like to thank the Team Foundation Build Team (especially <a href="http://blogs.msdn.com/buckh/">Buck Hodges</a> and <a href="http://blogs.msdn.com/aaronhallberg/">Aaron Hallberg</a>) who have been incredibly helpful through the development of the build functionality in Teamprise 3.0 while they were also busy working on TFS 2008.&#160; </p>

<p>Hopefully that gives you a quick flavour of Teamprise 3.0 and where we are going with this release.&#160; If you head over to the new site now and take a look at the many improvements we've made, we'd love to <a href="http://support.teamprise.com">hear what you think</a>.</p>




<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/teamprise/000421.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/teamprise/000421.html"> 5:06 PM</a>
	
	| <a href="http://www.woodwardweb.com/teamprise/000421.html#comments">Comments (3)</a>
	
	
</div>

</div>





<h2 class="date">March  6, 2008</h2>


<div class="blogbody">

<a name="000419"></a>
<a href="http://www.woodwardweb.com/teamprise/000419.html">
<h3 class="title">Radio TFS</h3>
</a>
<p><a href="http://www.radiotfs.com/"><img height="150" alt="radiotfs" src="http://www.woodwardweb.com/WindowsLiveWriter/RadioTFS_137AC/radiotfs_43a95a17-406d-40b4-9654-a104c93aab0e.jpg" width="150" align="right" /></a> <a href="http://phacker.wordpress.com/">Paul Hacker</a>, <a href="http://teamsystemrocks.com/blogs/mickey_gousset/">Mickey Gousset</a> and I have recently started a <a href="http://www.radiotfs.com/">Team System related podcast</a> called <a href="http://www.radiotfs.com/">Radio TFS</a>. </p>  <p>While it is not going to win any awards any time soon, we've been having a lot of fun so we are going to continue to try and get one or two episodes out a month. If you have 40 or so minutes to kill, then feel free to <a href="http://www.radiotfs.com/ct.ashx?id=ecb4b81c-5a56-4c34-b572-9286ad9710fc&amp;url=http%3a%2f%2ffeeds.feedburner.com%2f%7er%2fradiotfs%2f%7e5%2f245499779%2fradiotfs_003.mp3">take a listen</a> and <a href="http://feeds.feedburner.com/radiotfs">subscribe</a>. </p>  <p>If you have any suggestions for topic or any questions about Team System that you would like answered then please drop us a line at <a href="mailto:radiotfs@gmail.com">radiotfs@gmail.com</a> or visit the website at <a href="http://www.radiotfs.com">http://www.radiotfs.com</a>.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/teamprise/000419.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/teamprise/000419.html">10:23 PM</a>
	
	| <a href="http://www.woodwardweb.com/teamprise/000419.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">February  5, 2008</h2>


<div class="blogbody">

<a name="000417"></a>
<a href="http://www.woodwardweb.com/vsts/000417.html">
<h3 class="title">Aligning Build Numbers with Assembly Versions in TFS2008.</h3>
</a>
<p>I like my build numbers to be the same number that my assemblies are versioned with (and my end deliverables).&#160; It just makes things easier to track, that way if I get a bug report in from a customer I can look at the version and easily look at the label in source control to see what code that included. In all deliverables provided to the customer, we always output the version obtained from the current assembly somewhere at the start of any diagnostic information, that way you can easily tell what version they are on and instantly track this back.&#160; This all helps to make it easy for bugs to be filed against the correct version and reported in which version they have been fixed (using the nice integration between Team Build and the Work Item tracking portion of TFS).</p>  <p>People are often surprised that this feature does not work &quot;out the box&quot; with Team Build, so I thought I would just take the time to document how I made this work for us internally.&#160; As you'll be able to see, in TFS2008 all the basic hooks are provided for us to support this way of working.</p>  <p>Firstly, our .NET version numbering uses a slightly different scheme to our Java version numbering.&#160; In our Java products, the &quot;build number&quot; portion of the version number is actually the <a href="http://www.woodwardweb.com/vsts/000329.html">changeset number of TFS at that point in time</a>.&#160; In .NET there are 4 components to a typical assembly version number (1.0.1234.5678) and the maximum value for each number is 65535.&#160; Our production TFS server is currently at changeset 7698 which means that we would get about 6 years out of such a build numbering scheme for .NET - that would be perfectly satisfactory if you had a changeset epoch after each major release (so you would reset the build number to be current changeset - 7698 if we did a major version today).&#160; However Team Build needs a unique name for each build - using a changeset based approach risks having two builds with the same build number.&#160; So rather than do a changeset based system, I decided to make the .NET build numbers be a straight-forward incrementing number. I rely of the default functionality of Team Build to create a label for that build number to track the number back to version control.&#160; The incrementing number value is stored in a file on the default drop location for the build.</p>  <p>Another thing that I should explain is that I don't personally like the &quot;standard&quot; Microsoft way of versioning assemblies as:-</p>  <blockquote>   <p>&lt;Major&gt;.&lt;Minor&gt;.&lt;Build&gt;.&lt;Service&gt;</p> </blockquote>  <p>To me, it reads much easier as:-</p>  <blockquote>   <p>&lt;Major&gt;.&lt;Minor&gt;.&lt;Service&gt;.&lt;Build&gt;</p> </blockquote>  <p>Where &lt;Build&gt; is the number that increments every time a build is performed.&#160; As far as I am concerned, this difference is mostly cosmetic as it doesn't change the way the CLR resolves the assembly versions, however feel free to correct me in the comments if I am talking rubbish.</p>  <p>So - onto how we accomplish this.&#160; Firstly, in TFS2008 there is a convenient target for you to override to generate your custom build numbers called &quot;BuildNumberOverrideTarget&quot;.&#160; The important thing is that each build number must be unique, therefore a good rule of thumb is to use something like BuildDefinitionName_1.0.0.1234.&#160; Inside the BuildNumberOverrideTarget you simply set &quot;BuildNumber&quot; property to be what you want.&#160; Here is ours:-</p>  <p>   <pre class="xml" name="code">&lt;PropertyGroup&gt; 
  &lt;VersionMajor&gt;1&lt;/VersionMajor&gt; 
  &lt;VersionMinor&gt;0&lt;/VersionMinor&gt; 
  &lt;VersionService&gt;0&lt;/VersionService&gt; 
  &lt;VersionBuild&gt;0&lt;/VersionBuild&gt; 
&lt;/PropertyGroup&gt;
&lt;Target Name=&quot;BuildNumberOverrideTarget&quot;&gt; 
  &lt;!-- Create a custom build number, matching the assembly version --&gt;      
  &lt;Message Text=&quot;Loading last build number from file &amp;quot;$(DropLocation)\buildnumber.txt&amp;quot;&quot; /&gt; 
  &lt;IncrementingNumber NumberFile=&quot;$(DropLocation)\buildnumber.txt&quot;&gt; 
    &lt;Output TaskParameter=&quot;NextNumber&quot; PropertyName=&quot;VersionBuild&quot; /&gt; 
  &lt;/IncrementingNumber&gt; 
  &lt;PropertyGroup&gt; 
    &lt;BuildNumber&gt;$(BuildDefinitionName)_$(VersionMajor).$(VersionMinor).$(VersionService).$(VersionBuild)&lt;/BuildNumber&gt; 
  &lt;/PropertyGroup&gt; 
  &lt;Message Text=&quot;Build number set to &amp;quot;$(BuildNumber)&amp;quot;&quot; /&gt;  
&lt;/Target&gt;</pre>
</p>

<p>The first thing I do is call a quick custom task I wrote that increments the build number stored in the passed file.&#160; I wanted to do this while keeping a lock on the file itself in case two builds tried to update the same file at the same time.&#160; We then take this new number and build the BuildNumber based upon that value.&#160; The code for the Incrementing Number task is very simple and is given below:-</p>

<div style="border-right: 1px solid; border-top: 1px solid; overflow: auto; border-left: 1px solid; width: 98%; line-height: 90%; border-bottom: 1px solid; height: 300px">
  <pre><span style="color: blue">using</span> System; 
<span style="color: blue">using</span> System.IO; 
<span style="color: blue">using</span> Microsoft.Build.Framework; 
<span style="color: blue">using</span> Microsoft.Build.Utilities; 

<p><span style="color: blue">namespace</span> Teamprise.Tasks <br />
{ <br />
    <span style="color: gray">/// &lt;summary&gt;</span> <br />
    <span style="color: gray">///   A simple task to increment the number stored in a passed file.</span> <br />
    <span style="color: gray">/// &lt;/summary&gt;</span> <br />
    <span style="color: blue">public</span> <span style="color: blue">class</span> IncrementingNumber : Task <br />
    { <br />
        <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">bool</span> Execute() <br />
        { <br />
            NextNumber = IncrementNumber(); <br />
            <span style="color: blue">return</span> <span style="color: maroon">true</span>; <br />
        } <br />
        <span style="color: blue">public</span> <span style="color: blue">int</span> IncrementNumber() <br />
        { <br />
            <span style="color: blue">using</span> (FileStream fs = <span style="color: blue">new</span> FileStream(NumberFile, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.None)) <br />
            { <br />
                StreamReader reader = <span style="color: blue">new</span> StreamReader(fs); </p>

<p>                <span style="color: blue">long</span> pos = <span style="color: maroon">0</span>; <br />
                String line = reader.ReadLine(); </p>

<p>                <span style="color: green">// Ignore comments in file</span> <br />
                <span style="color: blue">while</span> (line != <span style="color: blue">null</span> &amp;&amp; line.StartsWith(<span style="color: maroon">&quot;#&quot;</span>)) <br />
                { <br />
                    pos = pos + line.Length + System.Environment.NewLine.Length; <br />
                    line = reader.ReadLine(); <br />
                } </p>

<p>                <span style="color: blue">int</span> number = -<span style="color: maroon">1</span>; <br />
                <span style="color: blue">if</span> (line != <span style="color: blue">null</span>) <br />
                { <br />
                    number = Int32.Parse(line); <br />
                } <br />
                NextNumber = number + <span style="color: maroon">1</span>; </p>

<p>                <span style="color: green">// Rewind the file stream back to the beginning of the number part.</span> <br />
                fs.Position = pos; </p>

<p>                StreamWriter writer = <span style="color: blue">new</span> StreamWriter(fs); <br />
                writer.WriteLine(NextNumber.ToString()); <br />
                writer.Flush(); <br />
                writer.Close(); <br />
            } <br />
            <span style="color: blue">return</span> NextNumber; <br />
        } <br />
        [Required] <br />
        <span style="color: blue">public</span> <span style="color: blue">string</span> NumberFile { <span style="color: blue">get</span>; <span style="color: blue">set</span>; } <br />
        [Output] <br />
        <span style="color: blue">public</span> <span style="color: blue">int</span> NextNumber { <span style="color: blue">get</span>; <span style="color: blue">set</span>; } <br />
    } <br />
}</pre><br />
</div></p>

<p>You compile this code into an assembly of your choice that lives alongside the TFSBuild.proj file in the build configuration folder in source control and is this loaded using the UsingTask call at the begging of your MSBuild project, i.e.</p>

<div style="line-height: 90%">
  <pre><span style="color: blue">&lt;</span><span style="color: maroon">UsingTask</span> <span style="color: red">TaskName</span>=&quot;<span style="color: blue">Teamprise.Tasks.IncrementingNumber</span>&quot; 
           <span style="color: red">AssemblyFile</span>=&quot;<span style="color: blue">Teamprise.Tasks.dll</span>&quot; /<span style="color: blue">&gt;</span></pre>
</div>

<p>The next thing that we have to do is to take the new version and force this into the assemblyinfo files.&#160; Personally, I prefer the AssemblyInfo files stored in source control to have a certain well defined number for each release branch (i.e. 1.0.0.0), and make it the build server that versions them.&#160; Some people like to check these back into source control - if you do that, be sure to check them in with the special comment of &quot;***NO_CI***&quot; to ensure that the check-in does not trigger any CI builds potentially putting you into an infinite loop of building.</p>

<p>So, we modify our assembly version files after they have been downloaded from source control using a technique borrowed from <a href="http://richardsbraindump.blogspot.com/2007/07/versioning-builds-with-tfs-and-msbuild.html">Richard Banks</a>, our interpretation of this is given below:-</p>

<div style="line-height: 90%">
  <pre><span style="color: blue">&lt;</span><span style="color: maroon">ItemGroup</span><span style="color: blue">&gt;</span> 
  <span style="color: blue">&lt;</span><span style="color: maroon">AssemblyInfoFiles</span> <span style="color: red">Include</span>=&quot;<span style="color: blue">$(SolutionRoot)\**\assemblyinfo.cs</span>&quot; /<span style="color: blue">&gt;</span> 
<span style="color: blue">&lt;</span>/<span style="color: maroon">ItemGroup</span><span style="color: blue">&gt;</span>   
<span style="color: blue">&lt;</span><span style="color: maroon">Target</span> <span style="color: red">Name</span>=&quot;<span style="color: blue">AfterGet</span>&quot;<span style="color: blue">&gt;</span> 
  <span style="color: blue">&lt;</span>!-- Update all the assembly info files with generated version info --<span style="color: blue">&gt;</span> 
  <span style="color: blue">&lt;</span><span style="color: maroon">Message</span> <span style="color: red">Text</span>=&quot;<span style="color: blue">Modifying AssemblyInfo files under &amp;quot;$(SolutionRoot)&amp;quot;.</span>&quot; /<span style="color: blue">&gt;</span> 
  <span style="color: blue">&lt;</span><span style="color: maroon">Attrib</span> <span style="color: red">Files</span>=&quot;<span style="color: blue">@(AssemblyInfoFiles)</span>&quot; <span style="color: red">Normal</span>=&quot;<span style="color: blue">true</span>&quot; /<span style="color: blue">&gt;</span> 
  <span style="color: blue">&lt;</span><span style="color: maroon">FileUpdate</span> <span style="color: red">Files</span>=&quot;<span style="color: blue">@(AssemblyInfoFiles)</span>&quot;                                 
              <span style="color: red">Regex</span>=&quot;<span style="color: blue">AssemblyVersion\(&amp;quot;.*&amp;quot;\)\]</span>&quot;                 
              <span style="color: red">ReplacementText</span>=&quot;<span style="color: blue">AssemblyVersion(&amp;quot;$(VersionMajor).$(VersionMinor).$(VersionService).$(VersionBuild)&amp;quot;)]</span>&quot; /<span style="color: blue">&gt;</span> 
  <span style="color: blue">&lt;</span><span style="color: maroon">FileUpdate</span> <span style="color: red">Files</span>=&quot;<span style="color: blue">@(AssemblyInfoFiles)</span>&quot; 
              <span style="color: red">Regex</span>=&quot;<span style="color: blue">AssemblyFileVersion\(&amp;quot;.*&amp;quot;\)\]</span>&quot; 
              <span style="color: red">ReplacementText</span>=&quot;<span style="color: blue">AssemblyFileVersion(&amp;quot;$(VersionMajor).$(VersionMinor).$(VersionService).$(VersionBuild)&amp;quot;)]</span>&quot; /<span style="color: blue">&gt;</span> 
  <span style="color: blue">&lt;</span><span style="color: maroon">Message</span> <span style="color: red">Text</span>=&quot;<span style="color: blue">AssemblyInfo files updated to version &amp;quot;$(VersionMajor).$(VersionMinor).$(VersionService).$(VersionBuild)&amp;quot;</span>&quot; /<span style="color: blue">&gt;</span> 
<span style="color: blue">&lt;</span>/<span style="color: maroon">Target</span><span style="color: blue">&gt;</span></pre>
</div>

<p>As you can see, we are making use of the custom Attrib task that is provided by the essential <a href="http://msbuildtasks.tigris.org/">MSBuild Community Tasks</a> to set the files to read/write and then we are calling the MSBuild Community Task FileUpdate to do a couple of regular expression search replaces on the appropriate parts of the files.</p>

<p>And that's about all that needs to be done.&#160; Now our builds have nice incrementing numbers that have the version number included that is the same as the assembly info files.</p>
<link href="/css/SyntaxHighlighter.css" type="text/css" rel="stylesheet" /></link><script language="javascript" src="/js/shCore.js"></script><script language="javascript" src="/js/shBrushCSharp.js"></script><script language="javascript" src="/js/shBrushXml.js"></script><script language="javascript">

<p>dp.SyntaxHighlighter.ClipboardSwf = '/js/clipboard.swf';<br />
dp.SyntaxHighlighter.HighlightAll('code');</script></p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000417.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000417.html">11:19 AM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000417.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">January 28, 2008</h2>


<div class="blogbody">

<a name="000416"></a>
<a href="http://www.woodwardweb.com/vsts/000416.html">
<h3 class="title">Upgrading from TFS 2008 Trial to TFS 2008 Full</h3>
</a>
<p>One of the most frequent questions I get when talking to people about TFS if how to upgrade from the freely downloadable <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=B0155166-B0A3-436E-AC95-37D7E39A440C&amp;displaylang=en">90-day TFS 2008 trial</a> to a full version of TFS.&nbsp; Our TFS 2008 license key arrived at the weekend, so I thought I would take the opportunity to record the process.&nbsp; The first two steps have nothing to do with installing your license key, just purchasing it - but sadly are often the most complicated.&nbsp; Installing the actual key once received, is pretty trivial as I hope you will see.</p> <p><strong>Step 1:&nbsp; Purchase a TFS License Key.</strong></p> <p>This step is frequently mis-understood.&nbsp; You have to pay for the full version of TFS.&nbsp; Just because you are a partner of an MSDN subscriber, doesn't mean that you get TFS included.&nbsp; As an MSDN Subscriber, depending on your subscription type you do get access to a 5-user limited version of TFS called "Team Foundation Server Workrgoup Edition".&nbsp; However only Gold Partners or Partners with an ISV Competency get TFS included in their partner fees - everyone else has to purchase it.&nbsp; When connecting to TFS, you also need to make sure you have enough Team Foundation Server Client Access Licenses (CAL's) to cover your use - if you have a Team Suite flavor of MSDN then that gives you one CAL.</p> <p><strong>Step 2: Obtain TFS License Key.</strong></p> <p>The license key for TFS will be printed on a little sticker on the back of the media that it arrives on.&nbsp; If it didn't (perhaps because you purchased TFS via a volume licensing agreement) then there are ways around this to get the license key out of the media (look for a file called setup.sdb and open it in Notepad, look for [Product Key], usually at the bottom of the file, and you will find it there). </p> <p>Because getting a TFS License Key usually involves the physical delivery of the media, you should make sure that you factor this time into your purchasing decision.&nbsp; If (like most people) your purchasing process takes longer than you budgeted for - then you do have the ability to <a href="http://blogs.msdn.com/bharry/archive/2008/01/15/checking-your-tfs-version-and-extending-trials.aspx">extend your TFS Trial by an additional 30-days</a>.</p> <p><strong>Step 3: Enter TFS Maintanence Mode</strong></p> <p>Go to, Control Panel, Add Remove Programs.</p> <p>&nbsp;<a href="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-1_3.png"><img style="float: none; margin-left: 25px" height="197" alt="Add / Remove Programs" src="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-1_thumb.png" width="261" align="center"></a> </p> <p>Then find Microsoft Visual Studio 2008 Team Foundation Server in the list and press Change/Remove</p> <p><a href="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-2_2.png"><img style="float: none; margin-left: 25px" height="190" alt="Team Foundation Server Maintanence Mode" src="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-2_thumb.png" width="261" align="center"></a> </p> <p><strong>Step 4: Enter the Full Key for TFS</strong></p> <p>At the bottom of the maintenance dialog, you have the option to enter your full license key.&nbsp; </p> <p><a href="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-3_2.png"><img style="float: none; margin-left: 25px" height="233" alt="TFS2008 Maintence Dialog" src="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-3_thumb.png" width="261" align="center"></a> </p> <p>Note that there was a bug in the RTM version of TFS 2008 that means that workgroup edition doesn't have the ability - see <a href="http://blogs.msdn.com/bharry/archive/2008/01/15/how-to-i-upgrade-to-a-proper-version-of-tfs-2008.aspx">this post</a> for details.&nbsp; This is TFS 2008 90-day trial, so it works just fine for us.</p> <p>Enter your license key and press Next.&nbsp; Note that this will install the license key and fire up a command window for a few seconds while it restarts IIS for the TFS server.&nbsp; Once you are finished, you will get the following dialog.</p> <p><a href="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-4_2.png"><img style="float: none; margin-left: 25px" height="233" alt="License upgrade complete" src="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-4_thumb.png" width="261" align="center"></a></p> <p>And you are complete.&nbsp; If you really want to check that the new license key has taken hold, then you can fire up a copy of <a href="http://blogs.msdn.com/bharry/archive/2008/01/15/checking-your-tfs-version-and-extending-trials.aspx">Brian Harry's VersionDetection tool</a> to set your mind at rest.</p> <p><a href="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-5_2.png"><img style="float: none; margin-left: 25px" height="165" alt="Version Detection tool showing that my TFS has a proper license key installed." src="http://www.woodwardweb.com/WindowsLiveWriter/UpgradingfromTFS2008TrialtoTFS2008Full_A42E/sshot-5_thumb.png" width="261" align="center"></a> </p> <p>And there you go - running the final release (9.0.21022.8) with no expiry date :-)</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000416.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000416.html">11:40 AM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000416.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">January 24, 2008</h2>


<div class="blogbody">

<a name="000415"></a>
<a href="http://www.woodwardweb.com/teamprise/000415.html">
<h3 class="title">Accessing Team Build logs over the WAN</h3>
</a>
<p>In <a href="http://www.woodwardweb.com/teamprise/000413.html">a previous post</a>, I talked about how Windows file sharing sucks over the WAN. This is particularly annoying for me when trying to view the log of a TFS Build - especially if that build has failed and I want to know why in a hurry. On my computer (sitting on the end of a VPN nearly 4000 miles from my TFS instance), there is a delay of about 50-70 seconds to view the log file depending on the size and the speed of the link at that moment in time.&#160; During that time, Visual Studio is hanging waiting for the file to open.&#160; The issue is compounded by the fact that the rest of the Team Build UI - and in fact the whole of TFS access in general - is so speedy over the same VPN link, that I really notice the time delay accessing build logs.</p>  <p>Therefore - it didn't take too many 70-seconds delays for me to fire up a second instance of Visual Studio to create a work-around.&#160; In Visual Studio 2008 (and in the upcoming Teamprise 3.0 Team Build integration), if the log location provided is not a UNC style path (i.e. \\server\drop\build\BuildLog.txt) but a http:// address, then it will open the file in a browser instead.&#160; Accessing the build log over http helps in two important ways.</p>  <ol>   <li>HTTP is much less latency sensitive than accessing a file from a Windows share </li>    <li>A browser will display the contents of the file before it has finished loading.&#160; When accessing the build log directly from a file share, the application (i.e. Notepad) will have to wait until it has recieved the whole file before displaying any of it to you.&#160; These log files can get large - so the improvement in perceived speed is significant. (http:// urls are a lot more cross-platform friendly than UNC paths as well, which is nice for us Teamprise folks). </li> </ol>  <p>Therefore, I created&#160; a quick and dirty ASP.NET page that accessing the build log for a particular build over the network and streams the contents of a build log to the browser.&#160; I then add a target into my TFSBuild.proj file that sets the log location to be the http url rather than the default UNC address.</p>  <h4>LogView ASP.NET Page</h4>  <p>I am by no means an ASP.NET expert - so please feel free to highlight any glaring stupidity on my part if you know better.&#160; I know the code below is sub-optimal and presents some security considerations, however it is a quick work-around that I spent a couple of minutes over to solve my issue - so please treat this code as just that.</p>  <p>Create a new Web Application Project, with references to Microsoft.TeamFoundation.Client and Microsoft.TeamFoundation.Build.Client assemblies.&#160; Create a new aspx page - mine is called view.aspx.&#160; In the page mark-up, ensure it only contains the Page tag, and an output caching directive.&#160; Mine (which is in a C# project) looks like this.</p>  <p></p>  <pre><span class="cch1"><font color="gray"></font></span><i>&lt;%</i>@ Page Language<font color="blue" size="+1"><font color="blue" size="+1">=</font></font><font color="purple">&quot;C#&quot;</font> AutoEventWireup<font color="blue" size="+1"><font color="blue" size="+1">=</font></font><font color="purple">&quot;true&quot;</font> CodeBehind<font color="blue" size="+1"><font color="blue" size="+1">=</font></font><font color="purple">&quot;view.aspx.cs&quot;</font> Inherits<font color="blue" size="+1"><font color="blue" size="+1">=</font></font><font color="purple">&quot;LogViewer._Default&quot;</font> <i>%&gt;</i><span class="cch1"><font color="gray">
</font></span><i>&lt;%</i>@ OutputCache Duration<font color="blue" size="+1"><font color="blue" size="+1">=</font></font><font color="purple">&quot;2592000&quot;</font> Location<font color="blue" size="+1"><font color="blue" size="+1">=</font></font><font color="purple">&quot;Server&quot;</font> VaryByParam<font color="blue" size="+1"><font color="blue" size="+1">=</font></font><font color="purple">&quot;*&quot;</font> <i>%&gt;</i></pre>

<p>Now - the work is performed in the code behind.&#160;&#160; </p>

<p></p>

<div id="codesampleb" style="border-right: 1px solid; border-top: 1px solid; overflow: auto; border-left: 1px solid; width: 600px; border-bottom: 1px solid; height: 300px">
  <pre><span style="color: teal">  1</span> <span style="color: blue">using</span> System;
<span style="color: teal">  2</span> <span style="color: blue">using</span> System.IO;
<span style="color: teal">  3</span> <span style="color: blue">using</span> Microsoft.TeamFoundation.Build.Client;
<span style="color: teal">  4</span> <span style="color: blue">using</span> Microsoft.TeamFoundation.Build.Common;
<span style="color: teal">  5</span> <span style="color: blue">using</span> Microsoft.TeamFoundation.Client;
<span style="color: teal">  6</span> 
<span style="color: teal">  7</span> <span style="color: blue">namespace</span> LogViewer
<span style="color: teal">  8</span> {
<span style="color: teal">  9</span>     <span style="color: blue">public</span> <span style="color: blue">partial</span> <span style="color: blue">class</span> _Default : System.Web.UI.Page
<span style="color: teal"> 10</span>     {
<span style="color: teal"> 11</span>         <span style="color: blue">protected</span> <span style="color: blue">void</span> Page_Load(<span style="color: blue">object</span> sender, EventArgs e)
<span style="color: teal"> 12</span>         {
<span style="color: teal"> 13</span>             Response.Write(<span style="color: maroon">&quot;&lt;html&gt;&quot;</span>);
<span style="color: teal"> 14</span>             <span style="color: blue">string</span> teamFoundationServerUrl = Request.Params[<span style="color: maroon">&quot;TeamFoundationServerUrl&quot;</span>];
<span style="color: teal"> 15</span>             <span style="color: blue">string</span> buildUri = Request.Params[<span style="color: maroon">&quot;BuildUri&quot;</span>];
<span style="color: teal"> 16</span> 
<span style="color: teal"> 17</span>             <span style="color: blue">if</span> (String.IsNullOrEmpty(teamFoundationServerUrl))
<span style="color: teal"> 18</span>             {
<span style="color: teal"> 19</span>                 teamFoundationServerUrl = <span style="color: maroon">&quot;http://localhost:8080&quot;</span>;
<span style="color: teal"> 20</span>             }
<span style="color: teal"> 21</span> 
<span style="color: teal"> 22</span>             <span style="color: blue">if</span> (String.IsNullOrEmpty(buildUri))
<span style="color: teal"> 23</span>             {
<span style="color: teal"> 24</span>                 Response.Write(<span style="color: maroon">&quot;&lt;title&gt;LogViewer Error&lt;/title&gt;&lt;body&gt;A valid BuildUri must be passed&lt;/body&gt;&lt;/html&gt;&quot;</span>);
<span style="color: teal"> 25</span>                 Response.End();
<span style="color: teal"> 26</span>                 <span style="color: blue">return</span>;
<span style="color: teal"> 27</span>             }
<span style="color: teal"> 28</span> 
<span style="color: teal"> 29</span>             TeamFoundationServer tfs = <span style="color: blue">new</span> TeamFoundationServer(teamFoundationServerUrl);
<span style="color: teal"> 30</span>             IBuildServer buildServer = (IBuildServer) tfs.GetService(<span style="color: blue">typeof</span>(IBuildServer));
<span style="color: teal"> 31</span> 
<span style="color: teal"> 32</span>             IBuildDetail buildDetail = buildServer.GetBuild(<span style="color: blue">new</span> Uri(buildUri));
<span style="color: teal"> 33</span> 
<span style="color: teal"> 34</span>             String logFile = Path.Combine(buildDetail.DropLocation, BuildConstants.BuildLogFileName);
<span style="color: teal"> 35</span> 
<span style="color: teal"> 36</span>             Response.Write(<span style="color: maroon">&quot;&lt;title&gt;Build Log: &quot;</span> + buildDetail.BuildNumber + <span style="color: maroon">&quot;&lt;/title&gt;&lt;body&gt;\r\n&lt;pre&gt;&quot;</span>);
<span style="color: teal"> 37</span> 
<span style="color: teal"> 38</span>             StreamReader reader = File.OpenText(logFile);
<span style="color: teal"> 39</span>             String line = reader.ReadLine();
<span style="color: teal"> 40</span>             
<span style="color: teal"> 41</span>             <span style="color: blue">while</span>(line != <span style="color: blue">null</span>)
<span style="color: teal"> 42</span>             {
<span style="color: teal"> 43</span>                 WriteLine(line);
<span style="color: teal"> 44</span>                 line = reader.ReadLine();
<span style="color: teal"> 45</span>             }
<span style="color: teal"> 46</span>             reader.Close();
<span style="color: teal"> 47</span>             
<span style="color: teal"> 48</span>             Response.Write(<span style="color: maroon">&quot;&lt;/pre&gt;&lt;/html&gt;&quot;</span>);
<span style="color: teal"> 49</span> 
<span style="color: teal"> 50</span>             Response.End();
<span style="color: teal"> 51</span>             
<span style="color: teal"> 52</span>         }
<span style="color: teal"> 53</span> 
<span style="color: teal"> 54</span>         <span style="color: blue">private</span> <span style="color: blue">void</span> WriteLine(<span style="color: blue">string</span> line)
<span style="color: teal"> 55</span>         {
<span style="color: teal"> 56</span>             line = Server.HtmlEncode(line);
<span style="color: teal"> 57</span>             <span style="color: blue">if</span> (line.StartsWith(<span style="color: maroon">&quot;Target &amp;quot;&quot;</span>))
<span style="color: teal"> 58</span>             {
<span style="color: teal"> 59</span>                 line = <span style="color: maroon">&quot;&lt;strong&gt;&quot;</span> + line + <span style="color: maroon">&quot;&lt;/strong&gt;&quot;</span>;
<span style="color: teal"> 60</span>             }
<span style="color: teal"> 61</span>             Response.Write(line);
<span style="color: teal"> 62</span>             Response.Write(<span style="color: maroon">&quot;\r\n&quot;</span>);
<span style="color: teal"> 63</span>         }
<span style="color: teal"> 64</span>     }
<span style="color: teal"> 65</span> }
<span style="color: teal"> 66</span> </pre>
</div>

<p></p>

<p>As you can see - this is a very quick and dirty example.&#160; I am relying on the output caching of the ASP.NET page to provide any performance at all, and this code could be improved in many ways.&#160; However to walk you through the code;</p>

<p>I start by checking for a TeamFoundationServerUrl parameter, if not passed, I assume that this application is being installed on the TFS server itself so localhost:8080 will get me there. I show an error if the BuildUri is not passed.&#160; Inside the TFSBuild.proj file execution, the MSBuild properties $(TeamFoundationServerUrl) and $(BuildUri) are accessible and provide you all you need to be able to get how of the build that you are building.</p>

<p>Line 29 is me getting hold of the TFS instance, line 30 the build server and finally line 32 the build that I am currently executing.&#160; 3 lines to get everything I need to be able to query and modify the build information - you gotta love the TFS2008 build API ;-)</p>

<p>I then (line 34) get the build log path, which is always a file called BuildLog.txt in the drop folder.&#160; I then simply stream the file, line by line, into the response stream.</p>

<p>The WriteLine method is used to do this so that I can optionally do a bit of formatting to the lines as I stream them to the client.&#160; In this example, I am highlighting and lines that are the beginnings of a Target - just to make the log easier to read.</p>

<p>I then deploy this ASP.NET page onto an IIS server.&#160; In my case, I have it running on my production TFS server as a separate application (on a different port) and I have the application set to run as a defined user that has read access to the drop share along with read access to the TFS Build Store.&#160; This means that anyone inside the network can anonymously access the web page and view the build log of any build - but that is acceptable in my organization.&#160; You might want to make access more secure - but then you will also have to be cleverer in your output caching decisions.</p>

<h4>TFSBuild.proj File Customization</h4>

<p>In the TFSBuild.proj file, I then override one of the provided hook targets to set the log location property of the build.&#160; I'm still un-decided as to which is the best target to put this in, but at the moment I'm going with BeforeGet.</p>

<p></p>

<div style="font-family: courier new"><span style="color: blue">&lt;</span><span style="color: maroon">Target</span>&#160;<span style="color: red">Name</span>=&quot;<span style="color: blue">BeforeGet</span>&quot;<span style="color: blue">&gt;</span>&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">SetBuildProperties</span>&#160;<span style="color: red">TeamFoundationServerUrl</span>=&quot;<span style="color: blue">$(TeamFoundationServerUrl)</span>&quot;&#160;&#160;&#160;&#160;&#160; <span style="color: red">BuildUri</span>=&quot;<span style="color: blue">$(BuildUri)</span>&quot;&#160;&#160;&#160;&#160;&#160; <span style="color: red">LogLocation=&quot;http://tfsserver:9090/logs/view.aspx?BuildUri</span>=$(BuildUri)&quot; /<span style="color: blue">&gt;</span> <span style="color: blue">&lt;</span>/<span style="color: maroon">Target</span><span style="color: blue">&gt;</span></div>

<p></p>

<p>As you can see - it is pretty low tech, but very effective.&#160; Clicking on the link starts providing me with log output with-in a second.</p>

<p>I actually have the web site running on port 9090 configured to give me directory browsing of the drop location file share (that is also located on the same server).&#160; This means that I can access my drop files using a browser by browsing to http://tfsserver:9090/ - however, you can not update the drop location of the build to be a http:// url.&#160; This is because the drop path is specified (and verified) as a UNC path and several parts of code in the build client API itself assume this.&#160; You could work around this by extending the ASP.NET page mechanism above to provide access to the files in the drop location - perhaps a future project for me ;-)</p>

<p>Rather a lengthy post this one - but I hope it helps someone else out of the same frustrations I was having.&#160; If you've read this far than I guess it was moderately interesting to you :-)</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/teamprise/000415.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/teamprise/000415.html">12:15 AM</a>
	
	| <a href="http://www.woodwardweb.com/teamprise/000415.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">January 23, 2008</h2>


<div class="blogbody">

<a name="000414"></a>
<a href="http://www.woodwardweb.com/tfs2008/000414.html">
<h3 class="title">Team System 2008 Interview with Brian Harry</h3>
</a>
<p><a href="http://blogs.msdn.com/briankel/">Brian Keller</a> has <a href="http://blogs.msdn.com/briankel/archive/2008/01/18/my-virtual-teched-interview-with-brian-harry.aspx">posted</a> a <a href="http://www.virtualteched.com/Videos/SA_1_bkeller_FINAL_500k.wmv">great interview</a> with <a href="http://blogs.msdn.com/bharry/">Brian Harry</a> about Visual Studio Team System 2008, and a lot of detail on the improvements in Team Foundation Server 2008.&#160; One of the things that I enjoy about talking with <a href="http://blogs.msdn.com/bharry/">Brian Harry</a> is that you get the information in a direct and clear way, with a complete absence of &quot;marketing speak&quot; or buzzword bingo.&#160; At just over 10 minutes in length, <a href="http://www.virtualteched.com/Videos/SA_1_bkeller_FINAL_500k.wmv">this interview</a> is a classic example of that and is densely packed with information - highly recommended.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs2008/000414.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs2008/000414.html">11:46 AM</a>
	
	| <a href="http://www.woodwardweb.com/tfs2008/000414.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">January 22, 2008</h2>


<div class="blogbody">

<a name="000413"></a>
<a href="http://www.woodwardweb.com/teamprise/000413.html">
<h3 class="title">Team Foundation Server over a VPN</h3>
</a>
<p>I connect to the central Teamprise TFS instance over a <a href="http://en.wikipedia.org/wiki/Virtual_private_network">VPN</a> connection to the head office in Champaign, IL.&#160; It is a direct distance of nearly 4,000 miles - but probably much longer depending what route my packets take - on a good day typical ping times for me are ~150ms, but bandwidth is also a major issue.&#160; On my current ADSL line (that is booked in for upgrade before the end of the month) I get 140 kbs upstream and about 400 kbs downstream - on a good day.&#160; On a bad day, it can be much worse.&#160; Last year someone decided to <a href="http://www.theregister.co.uk/2007/08/22/gunplay_triggers_net_slowdown/">start shooting at bits of fibre optic cable in Ohio</a> and that really messed up my day.</p>  <p>In many ways, the fact that Teamprise has a couple of the core development team working remotely over the VPN is good for Teamprise the product because we certainly complain if we encounter any performance issues during dogfooding - issues that the folks in the office with a gigabit connection to the TFS server might not feel as strong about :-)</p>  <p>TFS mostly works great for me over my VPN connection.&#160; The TFS team did a lot of work to optimise TFS traffic for <a href="http://en.wikipedia.org/wiki/Wide_area_network">WAN</a> environments, such as use of standard web based protocols for transport, the heavy use of compression, minimization of the SOAP payload, keeping connections cached and not to forget things like inventing the <a href="http://msdn2.microsoft.com/en-us/library/ms252490(VS.80).aspx">TFS Proxy Server</a> - you can certainly tell that TFS was designed with this type of environment in mind.&#160; (I'm sure it helps that the majority of the TFS team are based in Raleigh, NC while their dogfood TFS instance is based in Redmond, WA ;-) ).&#160;&#160; The only times where I have issues are on the rare occasion when Windows File Shares are used or the client needs to query Active Directory information.</p>  <p>Obviously - Windows file shares are an issue for Teamprise in general (with around 50% of the team using non-Windows systems as their primary machine).&#160; But most modern operating systems can talk to CIFS based file systems pretty well.&#160; The issue for me is that <a href="http://www.commsdesign.com/showArticle.jhtml;jsessionid=1YYKFIR11THECQSNDLPCKH0CJUNN2JVN?articleID=55301653">Windows file shares suck over a high-latency, low bandwidth connection</a>.&#160; This was one of the reasons <a href="http://www.woodwardweb.com/vsts/000169.html">VSS performed so badly over a WAN</a>.&#160; Thankfully there are only a couple of main areas in Team System and TFS where Windows file sharing is currently used:-</p>  <ol>   <li>Publishing of test results from the client </li>    <li>Accessing the TFS build drop location (and most annoyingly, the build log file). </li> </ol>  <p>Note, it because of these types of issues (and the Active Directory releated ones) that I always recommend people connecting into TFS remotely use a VPN if they want access to the full functionality.&#160; While the Windows file sharing bits may perform really badly - at least they will work over a VPN.&#160; Try getting file sharing to work securely between firewalls if TFS is exposed on the internet and a VPN is not used...</p>  <p>In a <a href="http://www.woodwardweb.com/teamprise/000415.html">follow up post</a>, I'm going to be talking about how to modify your builds to make them easier to work with over a WAN / VPN.&#160; Despite these minor niggles (which don't come up very often), if you are considering using TFS for use over a VPN or Wide Area Network then I would certainly recommend it.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/teamprise/000413.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/teamprise/000413.html"> 4:32 PM</a>
	
	| <a href="http://www.woodwardweb.com/teamprise/000413.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">January 16, 2008</h2>


<div class="blogbody">

<a name="000411"></a>
<a href="http://www.woodwardweb.com/tfs_top_tip/000411.html">
<h3 class="title">TFS Top Tip #15 - Baseline your Builds</h3>
</a>
<p>Microsoft Team Foundation Server 2008 has a great new improved build system (often referred to as "Team Build").&nbsp; An advantage of running your build from Team Build is that (by default) all changes between your current build and the last good one are reported in the build report and any work items that were associated with those changesets are automatically updated with the build number they were fixed in.</p> <p>However, when demonstrating this feature - the following thing always catches me out and is important to remember when using Team Build in production.&nbsp; The very first time you run a build, it does not associate that build with changesets or update any work items.</p> <p>Therefore, the first time your create a new build definition you should manually run a build and make sure it is successful.&nbsp; </p> <p>In fact I would recommend you do this anyway, even if the changeset association thing wasn't the case, after all you need to test that the new build definition you created actually works!</p> <p>The reason why Team Build 2008 works in this way is that when Team Build successfully completes a build it stores the label applied to that last good build.&nbsp; The next time it runs a build that is successful it will compare the two labels to detect which changesets were included in the build.&nbsp; It will then look over those changesets for any associated work items and update them to include the build number in which they were fixed.</p> <p>This tip is also true if you upgrade from TFS2005 to TFS2008.&nbsp; Once the upgrade is complete you should run your builds once manually to check that they are all still working fine and to give a baseline from which changes can be detected. </p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs_top_tip/000411.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs_top_tip/000411.html"> 7:36 AM</a>
	
	| <a href="http://www.woodwardweb.com/tfs_top_tip/000411.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">December  3, 2007</h2>


<div class="blogbody">

<a name="000406"></a>
<a href="http://www.woodwardweb.com/teamprise/000406.html">
<h3 class="title">Building Ant projects from Team Build</h3>
</a>
<p><b>Update: </b> With <a href="http://www.teamprise.com/">Teamprise 3.0</a> we included this work into the freely downloadable <a href="http://www.teamprise.com/products/build/">Teamprise Extensions for Team Build</a>.  The source is also provided under the MS-PL if you are interested.  You should definately look at <a href="http://www.teamprise.com/products/build/">the new version </a>as it contains some fixes and additional features based on feedback during beta testing.</p>

<p>Original Post:</p>
<p>With the recent release of Microsoft Visual Studio 2008 Team Foundation Server we are seeing more and more people looking to use the build capabilities of TFS (often referred to as "Team Build") to manage their Java based builds as well as their .NET ones.&nbsp; We have an MSBuild task available internally that we use to trigger Ant based builds and report the progress back into TFS, and I wanted to share this with a wider audience to get some feeedback.&nbsp; This task is heavily influenced by <a href="http://blogs.msdn.com/aaronhallberg/archive/2007/07/12/team-build-devenv-task.aspx" target="_blank">Aaron Hallberg's Team Build DevEnv task</a> which I encourage you to go look at if you are interested in getting other build systems integration with Team Build.</p> <p>You can download an early version of the Ant task from here - (<a href="http://people.teamprise.com/~martin/build/TeampriseBuildExtensions-1.0.0.140R.zip">TeampriseBuildExtensions</a> 1.1MB).&nbsp; There are two versions of the task included in the zip file - one for TFS2005 and one for TFS2008.&nbsp; Additionally there is a draft set of instructions included on how to get this working today.&nbsp; We hope to make the process much easier with future releases of Teamprise.</p> <p>The Ant task works by calling Java to run Ant. The task first parses the Ant file to locate the name of the project and the description. It then calls Ant and the resulting output from Ant is then parsed by the task to look for key information (such as javac and junit tasks) as well as to pass the results into the MSBuild log. Options which are normally available via ant launching script are available as additional attributes to the Ant task.  <h4>Example Usage</h4><code><pre>&lt;Ant TeamFoundationServerUrl="$(TeamFoundationServerUrl)" 
  BuildFile="$(SolutionRoot)\java\HelloWorld\build.xml" 
  BuildUri="$(BuildUri)" 
  AntHome="$(ANT_HOME)" 
  JavaHome="$(JAVA_HOME)" 
  Flavor="%(ConfigurationToBuild.FlavorToBuild)" 
  Platform="%(ConfigurationToBuild.PlatformToBuild)"   
  Properties="BinariesRoot=$(BinariesRoot);BuildNumber=$(BuildNumber);SourceGetVersion=$(SourceGetVersion)" /&gt;</pre></code>
<h4>Task Reference</h4>
<p>The following is a complete list of all the attributes supported by the task, note that many of them are best left to the default values unless a different behavior is explicitly required. Items that are in bold are the ones that are frequently used. </p>
<table class="MsoTableMediumShading1Accent3" style="border-right: medium none; border-top: medium none; border-left: medium none; border-bottom: medium none; border-collapse: collapse; mso-table-layout-alt: fixed; mso-border-alt: solid #b3cc82 1.0pt; mso-border-themecolor: accent3; mso-border-themetint: 191; mso-yfti-tbllook: 1184; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt" cellspacing="0" cellpadding="0" width="100%" border="1">
<thead>
<tr style="mso-yfti-irow: -1; mso-yfti-firstrow: yes">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: #b3cc82 1pt solid; padding-left: 5.4pt; background: #9bbb59; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-themecolor: accent3; mso-border-themetint: 191; mso-background-themecolor: accent3" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 5"><b><span lang="EN-US" style="color: white; mso-themecolor: background1">Parameter<?xml:namespace prefix = o /><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: #b3cc82 1pt solid; padding-left: 5.4pt; background: #9bbb59; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 1"><b><span lang="EN-US" style="color: white; mso-themecolor: background1">Required<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: #b3cc82 1pt solid; padding-left: 5.4pt; background: #9bbb59; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-themecolor: accent3; mso-border-themetint: 191; mso-background-themecolor: accent3" valign="top" width="397">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 1"><b><span lang="EN-US" style="color: white; mso-themecolor: background1">Description<o:p></o:p></span></b></p></td></tr></thead>
<tbody>
<tr style="mso-yfti-irow: 0; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">AntHome</span><span lang="EN-US"><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">No<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">Location of Ant on Build Server.<span style="mso-spacerun: yes">&nbsp; </span>If not specified then the value of the ANT_HOME environment variable will be used.<o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 1; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">AutoProxy<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">In Java 1.5+, use the OS proxies<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 2; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">BuildFile</span></b><b><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes"><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">No<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">Name of the build file to use, by default this is "build.xml" in the current directory.<o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 3; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">BuildUri</span><span lang="EN-US"><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">Yes<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">The team system URI which uniquely represents the instance of the build being run.<span style="mso-spacerun: yes">&nbsp; </span>With-in a Team Build MSBuild script, this is normally available in the MSBuild property $(BuildUri)<o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 4; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Debug<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><span lang="EN-US">Set to “true” to instruct Ant to print debugging information.<span style="mso-spacerun: yes">&nbsp; </span>By default this is set to “false”.<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 5; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">Flavor</span><span lang="EN-US"><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">No<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">The flavor of the build i.e. Release, Debug etc.<span style="mso-spacerun: yes">&nbsp; </span>This will default to "Release".<span style="mso-spacerun: yes">&nbsp; </span>In the Team Build MSBuild scripts, this is normally available as the global property </span></b><b style="mso-bidi-font-weight: normal"><span style="mso-ansi-language: en-gb; mso-bidi-language: ar-sa">%(ConfigurationToBuild.FlavorToBuild)</span><span lang="EN-US"><o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 6; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">InputHandler<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><span lang="EN-US">Specifies the Ant class which will handle input requests<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 7; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">JavaHome</span></b><b><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes"><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">No<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">Location of Java home directory on build server.<span style="mso-spacerun: yes">&nbsp; </span>If not specified then the value of the JAVA_HOME environment variable will be used.<o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 8; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">KeepGoing<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><span lang="EN-US">Instruct Ant to execute all targets that do not depend on failed target(s)<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 9; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Lib<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">Specifies a path for Ant to search for jars and classes.<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 10; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Listener<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><span lang="EN-US">Add an instance of an Ant class as a project listener<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 11; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Logger<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">Specify an Ant class to perform logging.<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 12; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Main<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><span lang="EN-US">Override Ant's normal entry point with specified Ant class.<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 13; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">NoClasspath<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">Run ant without using CLASSPATH<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 14; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Noinput<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><span lang="EN-US">Do not allow interactive input in Ant script<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 15; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">NoJavacBuildSteps<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">Set to “true” to suppress the reporting of javac steps to TFS. <span style="mso-spacerun: yes">&nbsp;</span>By default javac steps are added as build steps.<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 16; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">NoUserLib<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><span lang="EN-US">Run ant without using the jar files from ${user.home}/.ant/lib<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 17; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">Platform</span><span lang="EN-US"><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">No<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">The build platform i.e. Any CPU, x86, x64.<span style="mso-spacerun: yes">&nbsp; </span><span style="mso-spacerun: yes">&nbsp;</span>This will default to "Any CPU". <span style="mso-spacerun: yes">&nbsp;</span>In the Team Build MSBuild script, this is normally available as the global property </span></b><b style="mso-bidi-font-weight: normal"><span style="mso-ansi-language: en-gb; mso-bidi-language: ar-sa">%(ConfigurationToBuild.PlatformToBuild)</span><span lang="EN-US"><o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 18; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><b><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes">Properties<o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">No<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">Properties to pass to Ant in "name=value;name2=value2" syntax.<span style="mso-spacerun: yes">&nbsp; </span>When calling Ant, it is often useful to pass through properties from the originating MSBuild script – for example </span></b><b style="mso-bidi-font-weight: normal"><span style="mso-ansi-language: en-gb">Properties="BinariesRoot=$(BinariesRoot);BuildDefinitionName=$(BuildDefinitionName);"</span><span lang="EN-US"><o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 19; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">PropertyFile<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">Instruct Ant to load all properties from file with -D properties taking precedence<o:p></o:p></span></p></td></tr>
<tr style="mso-yfti-irow: 20; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">Target<o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">No<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">Single Ant Target to execute.<span style="mso-spacerun: yes">&nbsp; </span>If not specified then the default target specified in the script will be used. <span style="mso-spacerun: yes">&nbsp;</span>It is often useful to specify a target that is executed by Team Build and leave the default target to be what would get executed by a developer in a local workstation build.<o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 21; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Targets<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">Comma separated list of ant targets to execute.<o:p></o:p></span></p></td></tr>
<tr style="height: 3pt; mso-yfti-irow: 22; page-break-inside: avoid">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; height: 3pt; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 68"><b><span style="font-family: 'Courier New'; mso-ansi-language: en-gb; mso-bidi-language: ar-sa; mso-no-proof: yes">TeamFoundationServerUrl</span><span lang="EN-US"><o:p></o:p></span></b></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; height: 3pt; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 64"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">Yes<o:p></o:p></span></b></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; background: #e6eed5; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; height: 3pt; mso-background-themecolor: accent3; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-background-themetint: 63; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 64" align="left"><b style="mso-bidi-font-weight: normal"><span lang="EN-US">The URL of the Team Foundation Server to talk to. <span style="mso-spacerun: yes">&nbsp;</span>In the Team Build MSBuild script, this is often available in the property </span></b><b style="mso-bidi-font-weight: normal"><span style="mso-ansi-language: en-gb">$(TeamFoundationServerUrl)</span><span lang="EN-US"><o:p></o:p></span></b></p></td></tr>
<tr style="mso-yfti-irow: 23; page-break-inside: avoid; mso-yfti-lastrow: yes">
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: #b3cc82 1pt solid; width: 154.25pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-left-themecolor: accent3; mso-border-left-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="206">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 132"><span lang="EN-US" style="font-family: 'Courier New'; mso-bidi-language: ar-sa; mso-no-proof: yes; mso-bidi-font-weight: bold">Verbose<o:p></o:p></span></p></td>
<td style="border-right: medium none; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 49.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt" valign="top" width="66">
<p class="MsoNormal" style="text-justify: inter-ideograph; margin-bottom: 0pt; line-height: normal; text-align: justify; mso-yfti-cnfc: 128"><span lang="EN-US">No<o:p></o:p></span></p></td>
<td style="border-right: #b3cc82 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 297.65pt; padding-top: 0cm; border-bottom: #b3cc82 1pt solid; mso-border-top-themecolor: accent3; mso-border-top-themetint: 191; mso-border-bottom-themecolor: accent3; mso-border-bottom-themetint: 191; mso-border-top-alt: solid #b3cc82 1.0pt; mso-border-right-themecolor: accent3; mso-border-right-themetint: 191" valign="top" width="397">
<p class="MsoNormal" style="margin-bottom: 0pt; line-height: normal; text-align: left; mso-yfti-cnfc: 128" align="left"><span lang="EN-US">Set to “true” to instruct Ant to be extra verbose.<o:p></o:p></span></p></td></tr></tbody></table>
<p>As part of the next version of Teamprise we will be providing integration with Team Build in the UI (i.e. inside Eclipse based IDE's or in the stand-alone Teamprise Explorer client).&nbsp; More on those build capabilities soon - but hopefully you can see that with the ability to run Ant based builds from Team Build and the ability to control/monitor from Eclipse you will have a nice build system that is fully integrated with TFS.</p>
<p>If you find this task useful, then be sure to drop me a line with any feedback you might have.&nbsp; We have not yet decided how to make the source of this task available, either as an open source project of it's own or as part of a larger community of MSBuild tasks.&nbsp; There are pro's and con's to both.&nbsp; In the meantime, if anybody would like the source code then drop me a line.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/teamprise/000406.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/teamprise/000406.html"> 3:56 PM</a>
	
	| <a href="http://www.woodwardweb.com/teamprise/000406.html#comments">Comments (2)</a>
	
	
</div>

</div>





<h2 class="date">October 26, 2007</h2>


<div class="blogbody">

<a name="000390"></a>
<a href="http://www.woodwardweb.com/tfs_top_tip/000390.html">
<h3 class="title">TFS Top Tip #14: The only 2 things you need to know when customizing Team Build</h3>
</a>
<p>If you are customizing a team build, then there are only two things you need to know to get you started.&nbsp; The rest you can (mostly) figure out from there.</p> <ol> <li>Your build is defined in a file called TFSBuild.proj for your particular Team Build Type.&nbsp; You probably figured that bit out already.&nbsp; The first thing you need to know is that the TFSBuild.proj file inherits most of its logic from a file called Microsoft.TeamFoundation.Build.targets which lives in <br><code>%ProgramFiles%\MSBuild\Microsoft\VisualStudio\TeamBuild\Microsoft.TeamFoundation.Build.targets</code>.<br>If you open this file in Notepad you can see that it is exceptionally well commented.&nbsp; There is no smoke and mirrors with Team Build, if it happens at all then it triggered by this file. Note that you should <strong>never edit the Microsoft.TeamFoundation.Build.targets</strong> file.&nbsp; In Team Build 2008 there are so many hook points provided for you to insert your own logic into the build that you should never need to.&nbsp; Microsoft goes to some rather extreme lengths to ensure backwards compatibility with this file (i.e. a TFSBuild.proj file written with the TFS2005 targets file in mind will work just great with the 2008 targets file).&nbsp; If you modify the targets file, not only are you setting your self up for deployment nightmares but you servicing nightmares as well if you attempt to upgrade to later version or even possibly service packs - don't say I didn't tell you ;-) <li>If you get a bit lost in reading the targets file - the MSDN help for build customizations is pretty good.&nbsp; The best starting point is the page "<a href="http://msdn2.microsoft.com/en-us/library/ms400710(VS.90).aspx">Understanding Team Foundation Build Configuration Files</a>" - however the pages that this links to that I refer to constantly are <a href="http://msdn2.microsoft.com/aa337604(VS.90).aspx">Customizable Team Foundation Build Targets</a> and <a href="http://msdn2.microsoft.com/aa337598(VS.90).aspx">Customizable Team Foundation Build Properties</a>.&nbsp; That said - most of the comments in those MSDN help pages are actually in the targets file itself - just sometimes the property or task you are after is easier to find in the MSDN help.</li></ol>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs_top_tip/000390.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs_top_tip/000390.html">11:09 PM</a>
	
	| <a href="http://www.woodwardweb.com/tfs_top_tip/000390.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">July 21, 2007</h2>


<div class="blogbody">

<a name="000373"></a>
<a href="http://www.woodwardweb.com/tfs_top_tip/000373.html">
<h3 class="title">TFS Top Tip #13 - Watch where you drop stuff</h3>
</a>
<p>With Team Build in Team Foundation Server, you can have multiple build types for multiple projects.&nbsp; For example, we have a build that runs fast that we can have running <a href="http://en.wikipedia.org/wiki/Continuous_Integration">Continuous Integration</a> on, and a slower build (that does obfuscation, release packaging etc) that is run on demand when we want to perform a release to QA (some of which later go on to become public releases).</p> <p>A neat feature in the Team Build stuff is that you specify a drop location for your builds and the packaged binaries along with the build log and test results will be placed in a folder corresponding to the build name.&nbsp; In all the demos you see, this will typically be specified as something like <a href="file://\\server\drop">\\server\drop</a> and you may well do this yourself at first.&nbsp; Pretty quickly the drop folder will fill up with builds and get confusing.</p> <p>A better way is a rather simple solution that I almost didn't mention, however&nbsp;when I mentioned this to a friend of mine and it caused some head-slapping, so I thought I'd discuss it here.&nbsp; Apologies if you'd already figured this out this rather basic step.</p> <p>Simply, put your builds into folders.&nbsp; Something like:-</p> <ul> <li>\\server\drop\product\buildType\</li></ul> <p>To give an example:-</p> <ul> <li>\\jeeves\drop\teamprise\ci  <li>\\jeeves\drop\teamprise\release</li></ul> <p>You can obviously take this further if need be.&nbsp; For example we currently have builds going on in two main places, we are putting Teamprise 2.2 through final testing while, in parallel, we work on the next major release in trunk.&nbsp; In the example above,&nbsp;it means we have 4 builds types in total and&nbsp;can follow the convention of \\server\drop\product\branch\buildType&nbsp;to make:-</p> <ul> <li>\\jeeves\drop\teamprise\2.2\ci  <li>\\jeeves\drop\teamprise\2.2\release  <li>\\jeeves\drop\teamprise\trunk\ci  <li>\\jeeves\drop\teamprise\trunk\release</li></ul> <p>&nbsp;Pretty simple really, but helps to plan this stuff up front.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs_top_tip/000373.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs_top_tip/000373.html"> 5:13 AM</a>
	
	| <a href="http://www.woodwardweb.com/tfs_top_tip/000373.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">January  4, 2007</h2>


<div class="blogbody">

<a name="000318"></a>
<a href="http://www.woodwardweb.com/tfs_top_tip/000318.html">
<h3 class="title">TFS Top Tip #12 - Specifying a proxy server at the command line</h3>
</a>
<p>If (<a href="http://www.woodwardweb.com/vsts/000273.html">like me</a>) you are using the <a href="http://msdn2.microsoft.com/en-us/cc31bk2e(VS.80).aspx">tf.exe</a> command line to access your Team Foundation Server via a Version Control Proxy from a remote office, then the following tip is extremely useful - much more so than my previous <a href="http://www.woodwardweb.com/vsts/000286.html">registry hack</a>.&nbsp; </p> <p>There is currently no option with the Microsoft command line to pass a version control proxy server in to TF.exe.&nbsp; It will pick one up if you have one set in the registry if you have used&nbsp;the Team Explorer GUI&nbsp;- but that isn't great for scripted scenarios.&nbsp; <a href="http://blogs.msdn.com/jmanning/">James Manning</a> recently pointed me in the direction of an undocumented environment variable called TFSPROXY.&nbsp; If set, the TFS client will use that setting to proxy your requests.&nbsp; Therefore the following will call tf.exe passing a proxy server to use in your connection:-</p> <blockquote><pre>@echo off
setlocal
set TFSPROXY=http://your_proxy_server:8081
tf %*
endlocal</pre></blockquote>
<p>I saved this in a batch file called "tfvp.cmd" (for "tf via proxy"), therefore if I want to call tf via my proxy and I'm in a shell that doesn't have the environment variable set I can call my script.</p>
<p>The only command that this really useful for is when doing a tfs get command, as only the download is sent via the version control proxy server,&nbsp;the majority of requests go direct to the&nbsp;main Team Foundation Server application tier that you are connected to.</p>
<p>By the way, if you are using the&nbsp;Teamprise command line&nbsp;client then you can use the&nbsp;/proxy:http://your_proxy_server:8081 argument to specify a proxy server to use for the connection, I've just logged a bug so that we will also accept this undocumented environment variable, but we'll make it so that passing one explicitly will override any picked up from the environment variable.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs_top_tip/000318.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs_top_tip/000318.html"> 4:07 PM</a>
	
	| <a href="http://www.woodwardweb.com/tfs_top_tip/000318.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">December 12, 2006</h2>


<div class="blogbody">

<a name="000312"></a>
<a href="http://www.woodwardweb.com/tfs_top_tip/000312.html">
<h3 class="title">TFS Top Tip #11 - Removing source control files from your local file system</h3>
</a>
<p>One of the questions that came up from one of our users was "how do I delete the files from my local file system - and tell Team Foundation Server that I have done this".</p> <p>The first thing you might try is to just delete them locally.&nbsp; However, Team Foundation Server (TFS)&nbsp;uses your <a href="http://msdn2.microsoft.com/en-us/library/ms181383(VS.80).aspx">workspace</a> to keep track of what files you have downloaded and what version you have of them.&nbsp; The reason it does this is so that it can maintain your files without a costly (both in terms of network and CPU processing) sync step.&nbsp; With TFS, when you say "Get latest", you only get the latest version of files that have changed since you last got them.&nbsp; Nothing is downloaded that you don't need (thereby saving you network traffic).&nbsp; A really neat thing about TFS is that if you delete a file on the server and check that delete in, then when somebody does a "Get Latest", the file is deleted&nbsp;on their local system as well -&nbsp;very nice.&nbsp; Moves and renames also exhibit this behavior -&nbsp;really useful for keeping&nbsp;the local file system in sync with the servers.&nbsp; </p> <p>But, if you have deleted a file locally (using Windows Explorer for example)&nbsp;then do a "Get Latest" the file is not downloaded - because the server thinks you already have it.&nbsp; You can easily download the file by going to "Get Specific Version..." and selecting the "Force get" option - which will download all files, regardless of if the server things you have them or not.</p> <p>The question I was asked was how&nbsp;to tell the server&nbsp;you have removed the file&nbsp;from&nbsp;your system, without deleting it from the server.&nbsp; In the end, it took me a while to figure out the answer (and the help of <a href="http://blogs.msdn.com/buckh/">Buck Hodges</a>)</p> <p><img style="float: none; margin-left: 25px" height="307" alt="The Get Specific Dialog with changeset 1 inside." src="http://www.woodwardweb.com/WindowsLiveWriter/TFSTopTip11Removingsourcecontrolfilesfro_B380/get_changeset_1%5B2%5D.png" width="514"> </p> <p>The answer is, if you do a "Get Specific Version..." on the files, and select <a href="http://msdn2.microsoft.com/en-us/library/ms181408(VS.80).aspx">Changeset</a> 1, the files will be deleted locally and the server will know this.&nbsp; The color of the file in the Source Control explorer will go from black to gray and will have the phrase "Not downloaded" in the latest column.</p> <p><a href="http://msdn2.microsoft.com/en-us/library/ms181408(VS.80).aspx">Changeset</a> 1 is a special <a href="http://msdn2.microsoft.com/en-us/library/ms181408(VS.80).aspx">changeset</a> on your Team Foundation Server instance.&nbsp; It was created as part of the setup routine and only contains one thing - the root node ($/) in your source control tree.&nbsp; If you do a get for <a href="http://msdn2.microsoft.com/en-us/library/ms181408(VS.80).aspx">changeset</a> 1 on any actual files then they will not exist at that point in time on the system so will be deleted locally and the server will know this.</p> <p>Anyway, I thought this worthy of a TFS Tip post.&nbsp; Not only because it highlights how to do something that is non-obvious, but also because once you understand how it works, you will&nbsp;understand&nbsp;a large part&nbsp;of what you need to know about Team Foundation Server Source Control.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/tfs_top_tip/000312.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/tfs_top_tip/000312.html">12:45 PM</a>
	
	| <a href="http://www.woodwardweb.com/tfs_top_tip/000312.html#comments">Comments (2)</a>
	
	
</div>

</div>





<h2 class="date">October  5, 2006</h2>


<div class="blogbody">

<a name="000291"></a>
<a href="http://www.woodwardweb.com/vsts/000291.html">
<h3 class="title">TFS Top Tip #10 - Keep Your Shelves Tidy</h3>
</a>
<p>Team Foundation Server source control has a great feature called Shelving.&nbsp; Shelving lets you set store a batch of pending changes onto the server and optionally remove them from your local workspace.&nbsp; It comes in really handy for the times when you want to backup your code and store it on the server but don't want to commit it to source control.&nbsp; I also sometimes use it when I would like a remote colleague to take a look at some code I have written before I commit it into the code base.&nbsp; For more information about Shelving, see the <a href="http://msdn2.microsoft.com/en-us/library/ms181403.aspx">MSDN documentation</a>.&nbsp; A Shelveset is identified by developer and the name the developer gave it when shelving.</p> <p>One of the features of shelving (and how it differs from working in a private developer branch) is that a Shelveset is in itself not versioned.&nbsp; If the same developer saves a Shelveset with the same name, then it will overwrite the previous Shelveset.&nbsp; This comes in really handy when you have a Shelveset that you commonly use for one thing - for example, I have a Shelveset that I normally call "Work In Progress" (actually, I normally call it "wip" because I am lazy when it comes to typing, but you get the idea).&nbsp; If I need to stop work, but I haven't been able to get to a point where I can check-in the code, then I shelve the pending changes and call the Shelveset "Work In Progress".&nbsp; That way, I only have one of these and I know the purpose of it.</p> <p>However, most of the time when you shelve, it is a temporary thing.&nbsp; You create a Shelveset and then you unshelve it - and then you no longer want it.&nbsp; The old shelvesets will sit on your shelf gathering dust until you&nbsp;tidy them up by deleting them.&nbsp; The unshelve dialog has a "Delete" button that you can use to delete a particular shelveset.</p> <p><img style="border-top-width: 0px; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: 25px; border-right-width: 0px" height="380" src="http://www.woodwardweb.com/WindowsLiveWriter/TFSTopTip10KeepYourShelvesTidy_9031/Unshelve_Dialog%5B7%5D.png" width="535"> </p> <p>Additionally, if you press "Details", then you get to see more information about the shelveset in question - but you also get a couple of other options controlling the behavior that occurs while the unshelve is being performed:-</p> <p><img style="border-top-width: 0px; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: 25px; border-right-width: 0px" height="55" src="http://www.woodwardweb.com/WindowsLiveWriter/TFSTopTip10KeepYourShelvesTidy_9031/Shelveset_Details_Closeup%5B2%5D.png" width="230"> </p> <p>If you un-check the "Preserve shelveset on server" check-box then your shelveset will be automatically deleted after you successfully unshelve it - which is a quite handy (if slightly hidden) feature.</p> <p>It's good practice to delete the shelvesets when you no longer need them.&nbsp; Not only will it get rid of clutter for you, it will also help when another person is trying to unshelve something that you have placed there for them.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000291.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000291.html">11:03 AM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000291.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">August 31, 2006</h2>


<div class="blogbody">

<a name="000276"></a>
<a href="http://www.woodwardweb.com/vsts/000276.html">
<h3 class="title">TFS Top Tip #8 - Where to get help</h3>
</a>
<p>Recently, I've had a surge of emails asking various questions about Team Foundation Server and how to do certain things.&nbsp; While I always (eventually) respond, it can sometimes take me a while.&nbsp; If you have questions about Team Foundation Server then the best place to go is the <a href="http://forums.microsoft.com/MSDN/default.aspx?ForumGroupID=5&amp;SiteID=1">MSDN forums</a>.&nbsp; These forums are monitored by the VSTS team as well as by the Team System MVP's and other folks who know stuff about the product.&nbsp; Unlike a lot of&nbsp;newsgroups, these forums are actually a very welcoming and friendly place to ask questions.&nbsp; I personally hang out on the following forums:-</p> <ul> <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=22&amp;SiteID=1">Team Foundation Server - General</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=68&amp;SiteID=1">Team Foundation Server - Setup</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=478&amp;SiteID=1">Team Foundation Server - Version Control</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=479&amp;SiteID=1">Team Foundation Server - Work Item Tracking</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=477&amp;SiteID=1">Team Foundation Server - Administration</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=481&amp;SiteID=1">Team Foundation Server - Build Automation</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=482&amp;SiteID=1">Team Foundation Server - Process Templates</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=480&amp;SiteID=1">Team Foundation Server - Reporting</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=20&amp;SiteID=1">Visual Studio Team System - General</a></b>  <li><b><a href="http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=18&amp;SiteID=1">Visual Studio Team System - Developers</a></b></li></ul> <p>As well as the official <a href="http://forums.microsoft.com/MSDN/default.aspx?ForumGroupID=5&amp;SiteID=1">MSDN forums</a>, you can also try one of the community ones.&nbsp; These don't tend to get the traffic from Team folks but are still good resources.&nbsp; It's also a good place to ask questions that you might not want to ask on a Microsoft resource (such as how does TFS stack up against Product B) and get an answer from somebody who is not paid by Microsoft.</p> <ul> <li><a href="http://teamsystemrocks.com/forums/default.aspx">Team System Rocks</a> (excellent community resource site)  <li><a href="http://teamfoundationserver.org/Web/forums/default.aspx">TeamFoundationServer.org</a>&nbsp;(a new UK based resource)</li></ul> <p>At <a href="http://www.teamprise.com/">Teamprise</a> we also have our own <a href="http://support.teamprise.com">forum</a> and <a href="http://kb.teamprise.com">knowledge base</a> that are worth checking out if the question is related to use of Team Foundation Server from Java or on the Unix / Mac / Linux platforms.</p> <p>Before you ask the question, it is probably worth checking the <a href="http://msdn2.microsoft.com/en-us/library/ms181232.aspx">MSDN documentation</a> first or using your <a href="http://www.google.com/">favorite search engine</a>, but don't worry about asking if you can't find your answer - the folks on these forums are always happy to point you to the best resource.</p> <p>You never know, if you ask a question on these forums then you might still get me answering it if you are unlucky enough.&nbsp; By asking the question in a public forum you are doing a service for the next person that comes down the line with the same problem as they'll be able to see somebody else with the same issue and (hopefully) the answer.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000276.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000276.html">10:59 AM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000276.html#comments">Comments (0)</a>
	
	
</div>

</div>





<h2 class="date">May 19, 2006</h2>


<div class="blogbody">

<a name="000247"></a>
<a href="http://www.woodwardweb.com/vsts/000247.html">
<h3 class="title">TFS Top Tip #5 - What to do if you lock yourself out of your repository</h3>
</a>
<p><img alt="Inherit security settings option" src="http://www.woodwardweb.com/images/blog/tfs_properties_thumb.png" align="right" border="0" />This tip is a follow up from my rather less helpful post &ldquo;<a href="http://www.woodwardweb.com/vsts/000158.html">Don&rsquo;t Do That</a>&rdquo; where I discussed the &ldquo;Inherit security settings&rdquo; option in the security settings tab for the Source Control Explorer when talking to Team Foundation Server.&nbsp; The issue with this check-box is that if you un-tick it then all the settings for every group on that folder are removed meaning that you have to go through every group and make sure that they have the correct permissions before you press the OK button.&nbsp; Even if you are a project administrator and you un-tick this box and press OK without giving project administrators rights to the folder or file&nbsp;you will not be able to go back and adjust the permissions.</p>
<p>However, I have found a work around should you be left stranded in this way.&nbsp; If you log in to TFS with the credentials of somebody who is a local administrator on the server then you will be able to view the folder and reset the security permissions.&nbsp; The easiest way to do this is to log on locally to your TFS application tier machine as the TFSSetup user and use the source control explorer&nbsp;on that machine&nbsp;to rectify the problem.&nbsp; Obviously it is not ideal but at least you are not totally stranded.</p>
<p>Rather embarrassingly, I found this work-around totally by accident while up on stage&nbsp;presenting my recent talk &ldquo;<a href="http://www.woodwardweb.com/vsts/000237.html">Top Ten Tips for Team Foundation Server</a>&rdquo;.&nbsp; My finale was going to be trashing my TFS installation by un-ticking this box and pressing OK without giving the Project Administrators the appropriate rights &ndash; however it wasn&rsquo;t as dramatic as I&rsquo;d planned.&nbsp; Turns out that this was because I was also the TFSSetup user on the VPC I was using as the TFS server.&nbsp; At least next time I can make it dramatic&nbsp;and then&nbsp;show folks how to fix it!</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000247.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000247.html">10:03 AM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000247.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">April 28, 2006</h2>


<div class="blogbody">

<a name="000234"></a>
<a href="http://www.woodwardweb.com/vsts/000234.html">
<h3 class="title">TFS Top Tip #4:  The Command Line Client is your friend.</h3>
</a>
<p>If you are going to be doing more than the basic check-in / check-out options then it pays to get to know the command line client &ndash; tf.&nbsp; The command line client is actually the most flexible and powerful client to Team Foundation Version Control.</p>
<p>For more information, consult the <a href="http://msdn2.microsoft.com/en-us/library/cc31bk2e.aspx">MSDN help documentation</a>.&nbsp; <a href="http://www.teamprise.com/">Teamprise</a> users will be glad to hear that a large percentage of the commands are implemented in V1.0 of our command line client meaning that you can do these actions from a Mac or Unix box as well (<a href="http://kb.teamprise.com/article/view/8">install instructions are posted in the Knowledge Base</a>).&nbsp; If you are running on Windows then you are probably better off sticking to Microsoft&rsquo;s command line client that gets installed as part of the Team Foundation Server client installation (and accessible via a Visual Studio 2005 command shell).</p>
<p>For example, to show&nbsp;all the check-outs by everyone on a path in the repository:-</p>
<p><code>&nbsp; tf status /server:http://yourservernamehere:8080 /user:* /recursive $/TeamProject/</code></p>
<p>For more examples, see an excellent&nbsp;post from <a href="http://blogs.msdn.com/jmanning/archive/2006/04/07/571151.aspx">James Manning</a>&nbsp;or some of my previous posts:-</p>
<ul>
<li><a href="http://www.woodwardweb.com/dotnet/000116.html">Hatteras Command Line Tips</a> (from back when tf.exe was called h.exe which saved a keypress :-), however the documentation was no where near as good as it is now&nbsp;)</li>
<li><a href="http://www.woodwardweb.com/vsts/000143.html">Unlocking files in VSTS</a></li></ul>
<p>The command line client is also excellent for scripting purposes (our automated build system relies heavily on it).&nbsp; I urge you to spend a few moments with a strong cup of coffee, the <a href="http://msdn2.microsoft.com/en-us/library/cc31bk2e.aspx">help documentation</a> and just have a play around.&nbsp; Once you realise what commands are available then you&rsquo;ll know what&rsquo;s possible if you come across a situation in the future where you reach limitations in the UI.</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000234.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000234.html"> 4:39 PM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000234.html#comments">Comments (2)</a>
	
	
</div>

</div>





<h2 class="date">April 27, 2006</h2>


<div class="blogbody">

<a name="000230"></a>
<a href="http://www.woodwardweb.com/vsts/000230.html">
<h3 class="title">TFS Top Tip #3:  Removing the Resolve Check-In Action from a Work Item</h3>
</a>
<p>I don&rsquo;t know about you, but I love associating my check-ins with work items using the Pending Changes view, it makes it so easy to maintain requirements traceability and helps me feel less guilty as I&rsquo;m doing one more thing that I should have been doing for years.&nbsp; </p>
<p>The only problem with the default definitions for Bug and Task are that if you select the item then by default the &ldquo;Resolve&rdquo; check-in action is selected.&nbsp; This is annoying for me as it the action I want to take in probably about 5% of check-ins.&nbsp; 95% of the time I just want to associate and 90% of the time I forgot that I have to change the default setting and end up going back to the work item and re-activating it.</p>
<p><img style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FLOAT: none; MARGIN-LEFT: 25px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" alt="A bug with the Resolve and Associate actions displayed.  Resolve is the default." src="http://www.woodwardweb.com/blog/remove_resolve.png" border="0" /></p>
<p>The &ldquo;Resolve&rdquo; option is displayed when a state transition in the work item&rsquo;s workflow is defined as having an action defined for check-in.&nbsp; Below is the transition section from the MSF Agile Bug:-</p>
<div style="FONT-FAMILY: Courier New"><span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">TRANSITION</span>&nbsp;<span style="COLOR: red">from</span>="<SPAN style="color: blue">Active</SPAN>"&nbsp;<span style="COLOR: red">to</span>="<SPAN style="color: blue">Resolved</SPAN>"<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">REASONS</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">DEFAULTREASON</span>&nbsp;<span style="COLOR: red">value</span>="<SPAN style="color: blue">Fixed</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">REASON</span>&nbsp;<span style="COLOR: red">value</span>="<SPAN style="color: blue">Deferred</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">REASON</span>&nbsp;<span style="COLOR: red">value</span>="<SPAN style="color: blue">Duplicate</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">REASON</span>&nbsp;<span style="COLOR: red">value</span>="<SPAN style="color: blue">As&nbsp;Designed</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">REASON</span>&nbsp;<span style="COLOR: red">value</span>="<SPAN style="color: blue">Unable&nbsp;to&nbsp;Reproduce</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">REASON</span>&nbsp;<span style="COLOR: red">value</span>="<SPAN style="color: blue">Obsolete</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">REASONS</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">FIELDS</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">FIELD</span>&nbsp;<span style="COLOR: red">refname</span>="<SPAN style="color: blue">System.AssignedTo</SPAN>"<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">COPY</span>&nbsp;<span style="COLOR: red">from</span>="<SPAN style="color: blue">field</SPAN>"&nbsp;<span style="COLOR: red">field</span>="<SPAN style="color: blue">System.CreatedBy</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">FIELD</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">FIELD</span>&nbsp;<span style="COLOR: red">refname</span>="<SPAN style="color: blue">Microsoft.VSTS.Common.ActivatedDate</SPAN>"<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">READONLY</span>&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">FIELD</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">FIELD</span>&nbsp;<span style="COLOR: red">refname</span>="<SPAN style="color: blue">Microsoft.VSTS.Common.ActivatedBy</SPAN>"<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">READONLY</span>&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">FIELD</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">FIELD</span>&nbsp;<span style="COLOR: red">refname</span>="<SPAN style="color: blue">Microsoft.VSTS.Common.ResolvedBy</SPAN>"<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">COPY</span>&nbsp;<span style="COLOR: red">from</span>="<SPAN style="color: blue">currentuser</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">VALIDUSER</span>&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">REQUIRED</span>&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">FIELD</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">FIELD</span>&nbsp;<span style="COLOR: red">refname</span>="<SPAN style="color: blue">Microsoft.VSTS.Common.ResolvedDate</SPAN>"<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">SERVERDEFAULT</span>&nbsp;<span style="COLOR: red">from</span>="<SPAN style="color: blue">clock</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">FIELD</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">FIELDS</span><span style="COLOR: blue">&gt;</span> <br /><strong>&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">ACTIONS</span><span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span><span style="COLOR: maroon">ACTION</span>&nbsp;<span style="COLOR: red">value</span>="<SPAN style="color: blue">Microsoft.VSTS.Actions.Checkin</SPAN>"&nbsp;/<span style="COLOR: blue">&gt;</span> <br />&nbsp;&nbsp;<span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">ACTIONS</span><span style="COLOR: blue">&gt;</span></strong> <br /><span style="COLOR: blue">&lt;</span>/<span style="COLOR: maroon">TRANSITION</span><span style="COLOR: blue">&gt;</span></div>
<p>If you remove the actions section from the transition from Active to Resolved transition then the only check-in action available will be &ldquo;Associate&rdquo;.&nbsp; Admittedly, this means that I have to edit the work item after finishing checking in files to move it from Active to Resolved &ndash; but I find this works better for me.&nbsp; I usually leave a little comment in the history as I change the state to say (at a high level) what I did and in the case of bugs any help I need to give to help&nbsp;the fix be verified by the test verification team.</p>
<p>&nbsp;</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000230.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000230.html"> 1:35 PM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000230.html#comments">Comments (8)</a>
	
	
</div>

</div>





<h2 class="date">April 26, 2006</h2>


<div class="blogbody">

<a name="000229"></a>
<a href="http://www.woodwardweb.com/vsts/000229.html">
<h3 class="title">TFS Top Tip #2: Changing the Logged In User</h3>
</a>
<p><a href="http://www.woodwardweb.com/blog/username_cache.gif"></a><a href="http://www.woodwardweb.com/blog/username_cache.gif"></a><a href="http://www.woodwardweb.com/blog/username_cache.gif"></a><a href="http://www.woodwardweb.com/blog/username_cache.gif"></a><a href="http://www.woodwardweb.com/blog/username_cache.gif"><img alt="Windows User Cache Dialog" src="http://www.woodwardweb.com/blog/username_cache_thumb.jpg" align="right" border="0" /></a>When you connect to a Team Foundation Server, the Microsoft client API attempts to connect with your current credentials&nbsp;that the process is running with under Windows.&nbsp; If you are on a different domain than your TFS server or the user that you are logged in with does not have access, then you will be prompted to enter your login credentials using the standard login dialog box that you will be familiar with from Internet Explorer.</p>
<p>However, what if you pass credentials and now you would like to pass in a different set.&nbsp; In <a href="http://www.teamprise.com/">Teamprise</a> it is easy enough because we have to ask you them every time you connect.&nbsp; With the Microsoft API your credentials are cached in the standard windows store.</p>
<p>To access this store (and remove your cached credentials allowing you to re-authenticate as a different user) then go to Control Panel, User Accounts, Advanced Tab, Manage Passwords.&nbsp; You should then locate your TFS Server instance and select Remove.</p>
<p>&nbsp;</p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000229.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000229.html"> 3:15 PM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000229.html#comments">Comments (1)</a>
	
	
</div>

</div>





<h2 class="date">April 25, 2006</h2>


<div class="blogbody">

<a name="000228"></a>
<a href="http://www.woodwardweb.com/vsts/000228.html">
<h3 class="title">TFS Top Tip #1 - WIQL Seperators</h3>
</a>
<p></p>
<p>I thought I&rsquo;d try and post some quick Top Tips for Team Foundation Server &ndash; in no particular order apart from as I think of them.&nbsp; Today, this came up in the <a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=366920&amp;SiteID=1">forums</a> so I thought I&rsquo;d elaborate.</p>
<p>WIQL (pronounced Wickle), stands for Work Item Query Language and is what is used when talking to the work item store in Team Foundation Server.&nbsp; It has a SQL like construct and is used to pass queries to the server.&nbsp; Visual Studio 2005 comes with a Query Editor that generate WIQL.&nbsp; While the query editor is straightforward, it is pretty powerful and allows you to do most things.</p>
<p>However, the query editor is region sensitive which sometimes causes confusion.&nbsp; Take the following example where I am using an &ldquo;IN&rdquo; statement to list a set of values for the work item status:-</p>
<p><img style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FLOAT: none; MARGIN-LEFT: 25px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" alt="An example of using the IN statement in Visual Studio 2005 Work Item Query Editor" src="http://www.woodwardweb.com/blog/in_usage_example.png" border="0" /></p>
<p>Note that the values are separated by commas.&nbsp; Those of you from a SQL background find this very sensible, but what the query editor is actually doing is taking the list of values and converting them into the following WIQL statement:-</p>
<div style="FONT-FAMILY: Courier New">SELECT&nbsp;&nbsp;&nbsp;[System.Id],&nbsp;[System.WorkItemType],&nbsp;[Microsoft.VSTS.Common.Rank],&nbsp;[System.State],&nbsp;[System.AssignedTo],&nbsp;[System.Title]&nbsp; <br />FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkItems&nbsp; <br />WHERE&nbsp;&nbsp;&nbsp;&nbsp;[System.TeamProject]&nbsp;=&nbsp;@project&nbsp;&nbsp; <br />AND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[System.State]&nbsp;IN&nbsp;(<span style="COLOR: maroon">'Active'</span>,&nbsp;<span style="COLOR: maroon">'Pending'</span>,&nbsp;<span style="COLOR: maroon">'Proposed'</span>,&nbsp;<span style="COLOR: maroon">'Requested'</span>)&nbsp; <br />ORDER&nbsp;BY&nbsp;[Microsoft.VSTS.Common.Rank],&nbsp;[System.WorkItemType],&nbsp;[System.Id]</div>
<p>(A top sub-tip is that it is possible to save WIQL files from Visual Studio by editing the query then selecting File, Save Query As.. and then select file.&nbsp; To run a saved query from the file system double click the *.wiq file from explorer)</p>
<p>The comma separator used by the query editor is actually being picked up from the &ldquo;List separator&rdquo; of your regional settings (shown below)&nbsp;(Start, Control Panel, Regional Settings, Customize&hellip;)</p>
<p><a href="http://www.woodwardweb.com/blog/region_settings.png"><img style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FLOAT: none; MARGIN-LEFT: 25px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" alt="Region_settings" src="http://www.woodwardweb.com/blog/region_settings_thumb.jpg" border="0" /></a></p>
<p>If you are in one of the many regions of the world that use a different list separator then you have to use that in the Visual Studio 2005 Query Editor.&nbsp; For example, if I change my list separator to be a semi-colon and then re-edit the query in the Visual Studio 2005 Query Editor I get the following:-</p>
<p><img style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FLOAT: none; MARGIN-LEFT: 25px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" alt="Same WIQL, different list seperator" src="http://www.woodwardweb.com/blog/in_usage_example_semicolon.png" border="0" /></p>
<p>This behaviour has some interesting side effects.&nbsp; Remember when I said that the Visual Studio 2005 Query Editor &ldquo;allows you to do most things&rdquo;.&nbsp; Well, one small problem is forcing the editor to take a character to say that you want the following to be treated as a string.&nbsp; For example, if you have a comma in the text value you are trying to use in an &ldquo;IN&rdquo; statement then you are hosed because the query editor assumes that this is a new value in your list.&nbsp; For example, if you try the following:</p>
<p><img style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; FLOAT: none; MARGIN-LEFT: 25px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" alt="Query names" src="http://www.woodwardweb.com/blog/in_usage_example_names.png" border="0" /></p>
<p>This actually gets translated by the query editor as the following:</p>
<div style="FONT-FAMILY: Courier New">SELECT&nbsp;&nbsp;&nbsp;[System.Id],&nbsp;[System.WorkItemType],&nbsp;[Microsoft.VSTS.Common.Rank],&nbsp;[System.State],&nbsp;[System.AssignedTo],&nbsp;[System.Title]&nbsp; <br />FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkItems&nbsp; <br />WHERE&nbsp;&nbsp;&nbsp;&nbsp;[System.TeamProject]&nbsp;=&nbsp;@project&nbsp;&nbsp; <br />AND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[System.AssignedTo]&nbsp;IN&nbsp;(<span style="COLOR: maroon">''</span><span style="COLOR: maroon">'Woodward'</span>,&nbsp;<span style="COLOR: maroon">'Martin'</span><span style="COLOR: maroon">''</span>,&nbsp;<span style="COLOR: maroon">''</span><span style="COLOR: maroon">'Sell'</span>,&nbsp;<span style="COLOR: maroon">'Clark'</span><span style="COLOR: maroon">''</span>)&nbsp; <br />ORDER&nbsp;BY&nbsp;[Microsoft.VSTS.Common.Rank],&nbsp;[System.WorkItemType],&nbsp;[System.Id]</div>
<p>As you can tell, it parses on the commas first, which is not want you wanted at all.&nbsp; If you manually type in the WIQL correctly as <code>IN (&lsquo;Woodward, Martin&rsquo;, &lsquo;Sell, Clark&rsquo;)</code> then the query editor will display this as <code>Woodward, Martin, Sell, Clark</code> &ndash; which in turn gets treated as <code>IN (&lsquo;Woodward&rsquo;,&rsquo;Martin&rsquo;,&rsquo;Sell&rsquo;,&rsquo;Clark&rsquo;)</code> when the WIQL is generated by the editor.&nbsp; </p>
<p>Hey ho &ndash; <a href="http://www.csell.net/">Clark Sell</a> has a <a href="http://csell.net/PermaLink,guid,aae3824a-d5d5-4326-a5b0-d7ee1b5c1d25.aspx">post</a> about changing the regional settings to enable to to query assigned to names but be warned it may have nasty side effects in other programs on your machine.</p>
<p>Hmm.&nbsp; When I thought about posting a TFS Tip a day for the next couple of weeks I didn&rsquo;t intend them to be this long.&nbsp; Expect the next one to be more concise&hellip;</p>
<p><font size="1"><strong>Now playing:</strong> <a href="http://phobos.apple.com/WebObjects/MZSearch.woa/wa/advancedSearchResults?artistTerm=Carl Franklin">Carl Franklin</a> - <a href="http://phobos.apple.com/WebObjects/MZSearch.woa/wa/advancedSearchResults?songTerm=Avalon, AJAX, Vista, and more with Tim Huckaby&amp;artistTerm=Carl Franklin">Avalon, AJAX, Vista, and more with Tim Huckaby</a></font></p>



<div class="posted">
<div class = "shareblock"><script src="http://feeds.feedburner.com/~s/MartinWoodward?i=http://www.woodwardweb.com/vsts/000228.html" type="text/javascript" charset="utf-8"></script></div>


	Posted by Martin at <a href="http://www.woodwardweb.com/vsts/000228.html"> 4:13 PM</a>
	
	| <a href="http://www.woodwardweb.com/vsts/000228.html#comments">Comments (4)</a>
	
	
</div>

</div>


</div>

</div>


<div id="links">

<div class="sidetitle">
Sections
</div>
<div class="side">

<a href="http://www.woodwardweb.com/" TITLE="Martin Woodward">Home</a><br />

<a href="http://www.woodwardweb.com/Books/">Books (9)</a><br />

<a href="http://www.woodwardweb.com/Buddies/">Buddies (10)</a><br />

<a href="http://www.woodwardweb.com/Dotnet/">Dotnet (38)</a><br />

<a href="http://www.woodwardweb.com/Films/">Films (2)</a><br />

<a href="http://www.woodwardweb.com/Gadgets/">Gadgets (12)</a><br />

<a href="http://www.woodwardweb.com/Java/">Java (16)</a><br />

<a href="http://www.woodwardweb.com/Personal/">Personal (61)</a><br />

<a href="http://www.woodwardweb.com/Photos/">Photos (2)</a><br />

<a href="http://www.woodwardweb.com/Podcasting/">Podcasting (17)</a><br />

<a href="http://www.woodwardweb.com/Programming/">Programming (34)</a><br />

<a href="http://www.woodwardweb.com/Sandbox/">Sandbox (2)</a><br />

<a href="http://www.woodwardweb.com/Software/">Software (10)</a><br />

<a href="http://www.woodwardweb.com/Teamprise/">Teamprise (58)</a><br />

<a href="http://www.woodwardweb.com/Technology/">Technology (47)</a><br />

<a href="http://www.woodwardweb.com/tfs/">tfs (35)</a><br />

<a href="http://www.woodwardweb.com/tfs2005/">tfs2005 (20)</a><br />

<a href="http://www.woodwardweb.com/tfs2008/">tfs2008 (32)</a><br />

<a href="http://www.woodwardweb.com/TFS Top Tip/">TFS Top Tip (15)</a><br />

<a href="http://www.woodwardweb.com/Vista/">Vista (20)</a><br />

<a href="http://www.woodwardweb.com/Vsts/">Vsts (176)</a><br />

<a href="http://www.woodwardweb.com/Web Design/">Web Design (2)</a><br />

<a href="http://www.woodwardweb.com/Web Sites/">Web Sites (20)</a><br />

<a href="http://www.woodwardweb.com/Work/">Work (6)</a><br />

</div>

<div class="sidetitle">
Search
</div> 
<div class="side">
<form method="get" action="http://www.woodwardweb.com/mt/mt-search.cgi">
<input type="hidden" name="IncludeBlogs" value="2" />
<label for="search" accesskey="4">Search this site:</label><br />
<input id="search" name="search" size="20" /><br />
<input type="submit" value="Search" />
</form>
</div>

<div class="syndicate">
<a href="http://feeds.feedburner.com/MartinWoodward">Syndicate this site (XML)</a>
<br/><br/>
<a href="http://clustrmaps.com/counter/maps.php?url=http://www.woodwardweb.com" id="clustrMapsLink"><img src="http://clustrmaps.com/counter/index2.php?url=http://www.woodwardweb.com" border=0 alt="Locations of visitors to this page"onError="this.onError=null; this.src='http://www.meetomatic.com/images/clustrmaps-back-soon.jpg'; document.getElementById('clustrMapsLink').href='http://clustrmaps.com/'">
</a>
</div>


<div class="syndicate">
<a href="http://creativecommons.org/licenses/by/1.0/"><img alt="Creative Commons License" border="0" src="http://creativecommons.org/images/public/somerights" /></a><br />
This weblog is licensed under a <a href="http://creativecommons.org/licenses/by/1.0/">Creative Commons License</a>.
</div>


</div>

<div class="powered">
Powered by<br /><a href="http://www.movabletype.org">Movable Type 4.2-en</a><br />   

</div>

<br clear="all" />



</body>
</html>
